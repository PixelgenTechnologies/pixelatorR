% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/patch_detection.R
\name{expand_adjacency_matrix}
\alias{expand_adjacency_matrix}
\title{Expand an adjacency matrix to include higher-order neighborhoods}
\usage{
expand_adjacency_matrix(A, k = 1L, use_weights = FALSE)
}
\arguments{
\item{A}{An adjacency matrix. Can be a sparse matrix (\code{dgCMatrix})}

\item{k}{An integer specifying the neighborhood size. Each node will be
connected to nodes up to \code{k} steps away.}

\item{use_weights}{If \code{TRUE}, the transpose of the stochastic matrix
will be expanded. The resulting edge weights will correspond to the incoming
transition probabilities for a \code{k}-step random walk.}
}
\value{
An expanded adjacency matrix
}
\description{
The node neighborhoods are expanded by multiplying the adjacency matrix \code{k}
times. To make sure that all neighbors up to \code{k} steps away are included,
self-loops are added by setting the diagonal of \code{A} to 1. These self-loops
are removed from the resulting matrix after expansion. Note that the self-loops
affect how the transition probabilities are calculated. When \code{use_weights = FALSE},
the edge values of the result from the matrix multiplication corresponds to the
number of k-step random walks between any pair of nodes. For the expanded adjacency
matrix, we replace these edge values with 1 so that the adjacency matrix corresponds
to an unweighted graph with expanded neighborhoods.
}
