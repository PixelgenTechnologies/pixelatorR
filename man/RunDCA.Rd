% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generics.R,
%   R/differential_colocalization_analysis.R
\name{RunDCA}
\alias{RunDCA}
\alias{RunDCA.data.frame}
\alias{RunDCA.Seurat}
\title{Differential analysis (colocalization)}
\usage{
RunDCA(object, ...)

\method{RunDCA}{data.frame}(
  object,
  contrast_column,
  reference,
  targets = NULL,
  group_vars = NULL,
  coloc_metric = "pearson_z",
  min_n_obs = 0,
  alternative = c("two.sided", "less", "greater"),
  conf_int = TRUE,
  p_adjust_method = c("bonferroni", "holm", "hochberg", "hommel", "BH", "BY", "fdr"),
  cl = NULL,
  verbose = TRUE,
  ...
)

\method{RunDCA}{Seurat}(
  object,
  contrast_column,
  reference,
  targets = NULL,
  assay = NULL,
  group_vars = NULL,
  coloc_metric = "pearson_z",
  min_n_obs = 0,
  alternative = c("two.sided", "less", "greater"),
  conf_int = TRUE,
  p_adjust_method = c("bonferroni", "holm", "hochberg", "hommel", "BH", "BY", "fdr"),
  cl = NULL,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{object}{An object containing colocalization scores}

\item{...}{Not yet implemented}

\item{contrast_column}{The name of the column where the group labels are stored.
This column must include \code{target} and \code{reference}.}

\item{reference}{The name of the reference group}

\item{targets}{The name of the target groups. These groups will be compared to the reference group.
If the value is set to \code{NULL} (default), all groups available in \code{contrast_column} except
\code{reference} will be compared to the \code{reference} group.}

\item{group_vars}{An optional character vector with column names to group the tests by.}

\item{coloc_metric}{The polarity metric to use. Any numeric data column in the colocalization score table
can be selected. The default is "pearson_z".}

\item{min_n_obs}{Minimum number of observations allowed in a group. Target groups with less
observations than \code{min_n_obs} will be skipped.}

\item{alternative}{One of 'two.sided', 'less' or 'greater' (see \code{?wilcox.test} for details)}

\item{conf_int}{Should confidence intervals be computed? (see \code{?wilcox.test} for details)}

\item{p_adjust_method}{One of "bonferroni", "holm", "hochberg", "hommel", "BH", "BY" or "fdr".
(see \code{?p.adjust} for details)}

\item{cl}{A cluster object created by \code{\link[parallel]{makeCluster}},
or an integer to indicate number of child-processes (integer values are
ignored on Windows) for parallel evaluations. See Details on performance
in the documentation for \code{pbapply}. The default is NULL,
which means that no parallelization is used.
Note that warnings are not caught when using parallel processing.}

\item{verbose}{Print messages}

\item{assay}{Name of assay to use}
}
\value{
A \code{tbl_df} object with test results
}
\description{
Runs differential analysis on colocalization scores generated with the
\code{Pixelator} data processing pipeline.
}
\details{
If you are working with a \code{Seurat} object created with pixelatorR that contains
a \code{\link{CellGraphAssay}}, the colocalization scores are accessed directly from
the \code{\link{CellGraphAssay}} (see \code{\link{ColocalizationScores}}).

The input object should contain a \code{contrast_column} (character vector or factor)
that includes information about the groups to compare. A typical example is a column
with sample labels, for instance: "control", "stimulated1", "stimulated2". If the input
object is a \code{Seurat} object, the \code{contrast_column} should be available in
the \code{meta.data} slot. For those familiar with \code{FindMarkers} from Seurat,
\code{contrast_column} is equivalent to the \code{group.by} parameter.

The \code{targets} parameter specifies a character vector with the names of the groups
to compare \code{reference}. \code{targets} can be a single group name or a vector of
group names while \code{reference} can only refer to a single group. Both \code{targets}
and \code{reference} should be present in the \code{contrast_column}. These parameters
are similar to the \code{ident.1} and \code{ident.2} parameters in \code{FindMarkers}.
}
\section{Additional groups}{

The test is always computed between \code{targets} and \code{reference}, but it is possible
to add additional grouping variables with \code{group_vars}. If \code{group_vars} is used,
each comparison is split into groups defined by the \code{group_vars}. For instance, if we
have annotated cells into cell type populations and saved these annotations in a \code{meta.data}
column called "cell_type", we can pass "cell_type" to \code{group_vars="cell_type"} to split
tests across each cell type.
}

\section{Types of comparisons}{

Consider a scenario where we have a Seurat object (\code{seurat_object}) with MPX data.
\code{seurat_object} contains a \code{meta.data} column called "sampleID" that holds
information about what samples the MPX components originated from. This column could have
three sample IDs: "control", "stimulated1" and "stimulated2". In addition, we have a column
called "cell_type" that holds information about the cell type identity of each MPX component.
\enumerate{
\item If we want to compare the "stimulated1" group to the "control" group:
\preformatted{
dca_markers <- RunDCA(object = seurat_object,
                      contrast_column = "sampleID",
                      reference = "control",
                      targets = "stimulated1")
}
\item If we want to compare the "stimulated1" and "stimulated2" groups to the "control" group:
\preformatted{
dca_markers <- RunDCA(object = seurat_object,
                      contrast_column = "sampleID",
                      reference = "control",
                      targets = c("stimulated1", "stimulated2"))
}
\item If we want to compare the "stimulated1" and "stimulated2" groups to the "control" group, and split
the tests by cell type:
\preformatted{
dca_markers <- RunDCA(object = seurat_object,
                     contrast_column = "sampleID",
                     reference = "control",
                     targets = c("stimulated1", "stimulated2"),
                     group_vars = "cell_type")
}
}
}

\examples{
library(pixelatorR)
library(dplyr)

pxl_file <- system.file("extdata/five_cells",
  "five_cells.pxl",
  package = "pixelatorR"
)
# Seurat objects
seur1 <- seur2 <- ReadMPX_Seurat(pxl_file)
seur1$sample <- "Sample1"
seur2$sample <- "Sample2"
seur_merged <- merge(seur1, seur2, add.cell.ids = c("A", "B"))

# Subset data to run test on a few markers
seur_merged <- subset(seur_merged,
  features = c(
    "CD3", "CD4", "CD8", "CD19",
    "CD20", "CD45RA", "CD45RO"
  )
)

# Run DCA
dca_markers <- RunDCA(seur_merged,
  contrast_column = "sample",
  target = "Sample1", reference = "Sample2"
)
dca_markers

}
\seealso{
Other DA-methods: 
\code{\link{RunDPA}()}
}
\concept{DA}
\concept{DA-methods}
