% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generics.R,
%   R/differential_colocalization_analysis.R
\name{RunDCA}
\alias{RunDCA}
\alias{RunDCA.data.frame}
\alias{RunDCA.Seurat}
\title{Differential analysis (colocalization)}
\usage{
RunDCA(object, ...)

\method{RunDCA}{data.frame}(
  object,
  target,
  reference,
  contrast_column,
  group_vars = NULL,
  alternative = c("two.sided", "less", "greater"),
  conf_int = TRUE,
  p_adjust_method = c("bonferroni", "holm", "hochberg", "hommel", "BH", "BY", "fdr"),
  verbose = TRUE,
  ...
)

\method{RunDCA}{Seurat}(
  object,
  target,
  reference,
  contrast_column,
  assay = NULL,
  group_vars = NULL,
  alternative = c("two.sided", "less", "greater"),
  conf_int = TRUE,
  p_adjust_method = c("bonferroni", "holm", "hochberg", "hommel", "BH", "BY", "fdr"),
  verbose = TRUE,
  ...
)
}
\arguments{
\item{object}{An object containing colocalization scores}

\item{...}{Not yet implemented}

\item{target}{The name of the target group}

\item{reference}{The name of the reference group}

\item{contrast_column}{The name of the column where the group labels are stored.
This column must include \code{target} and \code{reference}.}

\item{group_vars}{An optional character vector with column names to group the tests by.}

\item{alternative}{One of 'two.sided', 'less' or 'greater' (see \code{?wilcox.test} for details)}

\item{conf_int}{Should confidence intervals be computed? (see \code{?wilcox.test} for details)}

\item{p_adjust_method}{One of "bonferroni", "holm", "hochberg", "hommel", "BH", "BY" or "fdr".
(see \code{?p.adjust} for details)}

\item{verbose}{Print messages}

\item{assay}{Name of assay to use}
}
\value{
A \code{tbl_df} object with test results
}
\description{
Runs differential analysis on Moran's Z colocalization scores generated with the
\code{Pixelator} data processing pipeline.
}
\details{
If you are working with a \code{Seurat} object containing a \code{\link{CellGraphAssay}},
the polarization scores are accessed directly from the \code{\link{CellGraphAssay}}.
A character vector or factor must be selected with \code{contrast_column} from the
input data (or @meta.data slot from a \code{Seurat} object) which holds the groups
to run the test for. The \code{target} and \code{reference} parameters should refer
to the names of the two groups used for the comparison and these names should be present in
the \code{contrast_column}.
}
\section{Additional groups}{

The test is always computed between \code{target} and \code{reference}, but it is possible
to add additional grouping variables with \code{group_vars}. If \code{group_vars} is used,
the test will be computed within each combination of groups. For instance, if we have annotated
cells into cell type populations across two conditions defined by \code{target} and \code{reference},
we can pass the name of a cell annotation column with \code{group_vars} to run the test
for each cell type.
}

\examples{
library(pixelatorR)
library(dplyr)
# Set arrow data output directory to temp for tests
options(pixelatorR.arrow_outdir = tempdir())

pxl_file <- system.file("extdata/five_cells",
                        "five_cells.pxl",
                        package = "pixelatorR")
# Seurat objects
seur1 <- seur2 <- ReadMPX_Seurat(pxl_file, overwrite = TRUE)
seur1$sample <- "Sample1"
seur2$sample <- "Sample2"
seur_merged <- merge(seur1, seur2, add.cell.ids = c("A", "B"))

# Subset data to run test on a few markers
seur_merged <- subset(seur_merged,
                      features = c("CD3", "CD4", "CD8", "CD19",
                                   "CD20", "CD45RA", "CD45RO"))

# Run DCA
dca_markers <- RunDCA(seur_merged, contrast_column = "sample",
                      target = "Sample1", reference = "Sample2")
dca_markers

}
\seealso{
Other DA-methods: 
\code{\link{RunDPA}()}
}
\concept{DA}
\concept{DA-methods}
