% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generics.R, R/restore_paths.R
\docType{methods}
\name{RestorePaths}
\alias{RestorePaths}
\alias{RestorePaths.MPXAssay}
\alias{RestorePaths.CellGraphAssay}
\alias{RestorePaths.CellGraphAssay5}
\alias{RestorePaths.Seurat}
\title{Restore PXL file paths}
\usage{
RestorePaths(object, ...)

\method{RestorePaths}{MPXAssay}(object, pxl_files_dir, verbose = TRUE, ...)

\method{RestorePaths}{CellGraphAssay}(object, pxl_files_dir, verbose = TRUE, ...)

\method{RestorePaths}{CellGraphAssay5}(object, pxl_files_dir, verbose = TRUE, ...)

\method{RestorePaths}{Seurat}(object, pxl_files_dir, assay = NULL, verbose = TRUE, ...)
}
\arguments{
\item{object}{An object}

\item{...}{Additional arguments. Currently not used.}

\item{pxl_files_dir}{The directory where the PXL files are stored}

\item{verbose}{Print messages}

\item{assay}{Assay name}
}
\value{
An object with updated PXL file paths
}
\description{
Updates the PXL file paths in an object with the paths in the specified directory.
}
\details{
Seurat objects created with \code{pixelatorR} store the MPX data
in a \code{\link{CellGraphAssay}} or \code{\link{CellGraphAssay5}} object.
For some analytical tasks, such as component visualization, you need
to load the component graphs in memory with \code{\link{LoadCellGraphs}}.

\code{\link{LoadCellGraphs}} reads data from the edgelist(s) stored in the PXL
files(s) that the Seurat object was created from (see \code{\link{ReadMPX_Seurat}}).
This means that the PXL files must be accessible in the \code{\link{CellGraphAssay}}
or \code{\link{CellGraphAssay5}} when you load the component graphs.
You can check the PXL file paths with \code{\link{FSMap}}.

If the PXL files are moved or copied to a different directory, \code{\link{LoadCellGraphs}}
will fail because the PXL file paths are invalid. \code{RestorePaths} can
be useful in these situations to update the PXL file paths in the Seurat object.
All you need is to provide the path to the directory where the PXL files are located.
}
\section{Exported Seurat objects}{

A typical situation when this function is useful is when you export a Seurat object
created with \code{pixelatorR} to an RDS file, and share it with someone else. To ensure
that all data is available for the recipient, you also need to share the raw PXL files
and make sure that the recipient updates the PXL file paths in the Seurat object with
\code{RestorePaths}.

For instance, let's assume that we have a Seurat object \code{seurat_obj} created with
\code{pixelatorR} and that the PXL files are stored in the directory \code{DATA_DIR}
on your local system. You can export the Seurat object to an RDS file with:
\preformatted{
saveRDS(seurat_obj, file = file.path(DATA_DIR, "seurat_obj.rds"))
}
The content of DATA_DIR might look like this:
\preformatted{
DATA_DIR
├── seurat_obj.rds
└── Sample01_pbmc.analysis.pxl
}
Now you can share the entire \code{DATA_DIR} folder with someone else. When the recipient
loads the RDS file in R, the PXL file paths in the Seurat object need to be updated,
because recipients \code{DATA_DIR} will be different from yours. Assuming that the recipient
has stored the PXL file and the RDS object in the directory \code{RECIPIENT_DATA_DIR},
the recipient can update the PXL file paths with:
\preformatted{
seurat_obj <- readRDS(file = file.path(RECIPIENT_DATA_DIR, "seurat_obj.rds"))
seurat_obj <- RestorePaths(seurat_obj, pxl_files_dir = RECIPIENT_DATA_DIR)
}
}

\examples{
library(pixelatorR)
library(dplyr)

# Load example data as a Seurat object
pxl_file <- system.file("extdata/five_cells",
  "five_cells.pxl",
  package = "pixelatorR"
)

# Copy PXL file to tempdir
tmp_pxl_file <- file.path(fs::path_temp(), "five_cells.pxl")
fs::file_copy(pxl_file, tmp_pxl_file)
seur_obj <- ReadMPX_Seurat(tmp_pxl_file)

# Now we can load graphs
seur_obj <- LoadCellGraphs(seur_obj, cells = colnames(seur_obj)[1])

# Removing or moving PXL file will make graphs inaccessible
fs::file_delete(tmp_pxl_file)
\dontrun{
# This will now fail since the PXL file is missing
seur_obj <- LoadCellGraphs(seur_obj, force = TRUE)
}

# We can restore paths to the PXL file using RestorePaths.
# All we need is to provide the path to a directory where the PXL file is located.
pxl_files_dir <- system.file("extdata/five_cells",
  package = "pixelatorR"
)
seur_obj <- RestorePaths(seur_obj, pxl_files_dir = pxl_files_dir)

# Now LoadCellGraphs should work as expected
seur_obj <- LoadCellGraphs(seur_obj, force = TRUE)

}
