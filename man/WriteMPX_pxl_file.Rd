% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/write_pxl_file.R
\name{WriteMPX_pxl_file}
\alias{WriteMPX_pxl_file}
\title{Export Seurat object MPX data to a PXL file}
\usage{
WriteMPX_pxl_file(
  object,
  file,
  assay = NULL,
  export_layouts = FALSE,
  overwrite = FALSE
)
}
\arguments{
\item{object}{A \code{Seurat} object with a \code{CellGraphAssay5}
assay object created with pixelatorR.}

\item{file}{A character string specifying the path to the PXL
file to be created.}

\item{assay}{A character string specifying the name of the \code{CellGraphAssay5}.
If set to \code{NULL} the default assay will be used.}

\item{export_layouts}{A logical value specifying whether to export the layouts from
the \code{Seurat} object. If set to \code{TRUE}, each component must have a layout.
See \code{\link{LoadCellGraphs}} and \code{\link{ComputeLayout}} for details about
how to load graphs and compute layouts.}

\item{overwrite}{A logical value specifying whether to overwrite the \code{file}
if it already exists.}
}
\value{
Nothing. The function writes the PXL file to the specified location.
}
\description{
\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}}

The function only exports the essential data required to create a functional
PXL file. See details below for a description of what data is exported.
}
\section{Exported data}{

\itemize{
\item Count data and metadata : The raw count matrix and component metadata from the Seurat object
are exported into a .h5ad file that can be read with the anndata Python library.
\item Polarization scores : The polarization scores are exported to a .parquet file.
\item Colocalization scores : The colocalization scores are exported to a .parquet file.
\item Edgelist data : The edgelist data is first collected from the original PXL file(s),
filtered to include the components currently available in the \code{Seurat} object,
and then the component IDs are updated. The resulting merged edgelist data is exported
to a .parquet file.
\item Sample meta data : The sample meta data is extracted from the original PXL file(s),
then merged and exported to a .json file.
}

The structure of the PXL file is detailed below:

|-- adata.h5ad\cr
|-- polarization.parquet\cr
|-- colocalization.parquet\cr
|-- metadata.json\cr
|-- edgelist.parquet

The merged files are converted into a zip archive and saved to the target PXL file.

NOTE: Factors are currently not supported. These will be converted to string arrays.
}

\examples{
# Use Assay5 as the default assay version
options(Seurat.object.assay.version = "v5")

# Create Seurat object
pxl_file <- minimal_mpx_pxl_file()
se <- ReadMPX_Seurat(pxl_file)

se_merged <- merge(se, list(se, se, se))
pxl_file <- fs::path_temp("small.pxl")

# Export data to a new PXL file
WriteMPX_pxl_file(se_merged, pxl_file)

# Read the new PXL file
se_merged <- ReadMPX_Seurat(pxl_file)

# Reset global option
options(Seurat.object.assay.version = "v3")

}
