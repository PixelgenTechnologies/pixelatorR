% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generics.R, R/pivot_tables.R
\docType{methods}
\name{PolarizationScoresToAssay}
\alias{PolarizationScoresToAssay}
\alias{PolarizationScoresToAssay.data.frame}
\alias{PolarizationScoresToAssay.MPXAssay}
\alias{PolarizationScoresToAssay.CellGraphAssay}
\alias{PolarizationScoresToAssay.CellGraphAssay5}
\alias{PolarizationScoresToAssay.Seurat}
\title{Convert polarization score table to an Assay or Assay5}
\usage{
PolarizationScoresToAssay(object, ...)

\method{PolarizationScoresToAssay}{data.frame}(object, values_from = c("morans_z", "morans_i"), ...)

\method{PolarizationScoresToAssay}{MPXAssay}(object, values_from = c("morans_z", "morans_i"), ...)

\method{PolarizationScoresToAssay}{CellGraphAssay}(object, values_from = c("morans_z", "morans_i"), ...)

\method{PolarizationScoresToAssay}{CellGraphAssay5}(object, values_from = c("morans_z", "morans_i"), ...)

\method{PolarizationScoresToAssay}{Seurat}(
  object,
  assay = NULL,
  new_assay = NULL,
  values_from = c("morans_z", "morans_i"),
  ...
)
}
\arguments{
\item{object}{An object with polarization scores}

\item{...}{Not yet implemented}

\item{values_from}{What column to pick polarization scores from. Either
"morans_i" or "morans_z"}

\item{assay}{Name of the \code{\link{CellGraphAssay}} to pull polarization scores from}

\item{new_assay}{Name of the \code{Assay} to store the polarization scores in}
}
\description{
Convert polarization score table to an Assay or Assay5
}
\section{Behavior}{


Takes an object with polarization scores in long format and returns an
object with polarization scores in a wide format. The polarization score
table includes Moran's I and Z scores along with p-values for each marker
and component.

The wide format is an array-like object with dimensions markers x components,
where each cell is filled with a polarization score. Scores that are missing
from the polarization score table are replaced with 0's.

Different outputs are returned depending on the input object type:

\itemize{
\item{
\code{tibble/data.frame}: returns a matrix with markers in rows and components
in columns
}
\item{
\code{CelGraphAssay}: returns an Assay with markers in rows and
components in columns
}
\item{
\code{Seurat} object: returns the Seurat object with a new Assay
with markers in rows and components in columns
}
}

As many functions provided in Seurat works on \code{Assay} objects, it is
sometimes convenient to make this conversion. For instance, if we want to
compute a UMAP on the polarization scores with \code{RunUMAP}, we need the
values to be formatted in an \code{Assay}. This also makes it possible
to use various visualization functions such as \code{VlnPlot} or \code{FeaturePlor}
to show the distribution of polarization scores.
}

\examples{
library(pixelatorR)
library(SeuratObject)

# Load example data as a Seurat object
pxl_file <- system.file("extdata/five_cells",
  "five_cells.pxl",
  package = "pixelatorR"
)
pol_scores <- ReadMPX_polarization(pxl_file)

# PolarizationScoresToAssay returns a matrix for a tbl_df
pol_scores_mat <- PolarizationScoresToAssay(pol_scores)
pol_scores_mat[1:4, 1:5]

# Create a Seurat object
seur <- ReadMPX_Seurat(pxl_file)

# Fetch CellGraphAssay and create new polarization
# scores Assay
cg_assay <- seur[["mpxCells"]]
class(cg_assay)
pol_assay <- PolarizationScoresToAssay(cg_assay)
class(pol_assay)

# Convert polarization scores within a Seurat object
seur <- PolarizationScoresToAssay(seur)

# After conversion, we now have a new assay called "polarization"
seur[["polarization"]]

# Switch default assay to polarization
DefaultAssay(seur) <- "polarization"

# Visualize polarization scores with Seurat
# VlnPlot(seur, features = "CD19") +
#   labs(y = "Polarization score")

}
\seealso{
Other Spatial metrics conversion methods: 
\code{\link{ColocalizationScoresToAssay}()},
\code{\link{ProximityScoresToAssay}()}
}
\concept{Spatial metrics conversion methods}
