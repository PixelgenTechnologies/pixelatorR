% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generics.R, R/differential_abundance_analysis.R
\name{RunDAA}
\alias{RunDAA}
\alias{RunDAA.Seurat}
\title{Differential analysis (abundance)}
\usage{
RunDAA(object, ...)

\method{RunDAA}{Seurat}(
  object,
  contrast_column,
  reference,
  targets = NULL,
  assay = NULL,
  group_vars = NULL,
  mean_fxn = Matrix::rowMeans,
  fc_name = "difference",
  p_adjust_method = c("bonferroni", "holm", "hochberg", "hommel", "BH", "BY", "fdr"),
  verbose = TRUE,
  ...
)
}
\arguments{
\item{object}{A Seurat object containing abundance data, such as counts or normalized counts}

\item{...}{Parameters passed to \code{FindMarkers}}

\item{contrast_column}{The name of the meta data column where the group labels are stored.
This column must include \code{targets} and \code{reference}.}

\item{reference}{The name of the reference group}

\item{targets}{The names of the target groups. These groups will be compared to the reference group.
If the value is set to \code{NULL} (default), all groups available in \code{contrast_column} except
\code{reference} will be compared to the \code{reference} group.}

\item{assay}{Name of assay to use}

\item{group_vars}{An optional character vector with column names to group the tests by.}

\item{mean_fxn}{Function to use for fold change or average difference calculation
in \code{FindMarkers}. See documentation for the \code{mean.fxn} parameter in
\code{FindMarkers} for more information.}

\item{fc_name}{Name of the fold change, average difference, or custom function
column in the output tibble. See documentation for the \code{fc.name} parameter in
\code{FindMarkers} for more information.}

\item{p_adjust_method}{One of "bonferroni", "holm", "hochberg", "hommel", "BH", "BY" or "fdr".
(see \code{?p.adjust} for details). The p values are adjusted across all tests and the replaces
the \code{p_val_adj} column generated by \code{FindMarkers}.}

\item{verbose}{Print messages}
}
\value{
A \code{tbl_df} object with test results
}
\description{
Runs differential analysis on abundance values generated with the
\code{Pixelator} data processing pipeline. The function is a wrapper around
the \code{FindMarkers} function from \code{Seurat} but provides a similar
interface as \code{\link{RunDPA}} and \code{\link{RunDCA}} from \code{pixelatorR}.
Currently, \code{RunDAA} only has a method for \code{Seurat} objects.
}
\details{
The input object should contain a \code{contrast_column} (character vector or factor)
that includes information about the groups to compare. A typical example is a column
with sample labels, for instance: "control", "stimulated1", "stimulated2". If the input
object is a \code{Seurat} object, the \code{contrast_column} should be available in
the \code{meta.data} slot. For those familiar with \code{FindMarkers} from Seurat,
\code{contrast_column} is equivalent to the \code{group.by} parameter.

The \code{targets} parameter specifies a character vector with the names of the groups
to compare \code{reference}. \code{targets} can be a single group name or a vector of
group names while \code{reference} can only refer to a single group. Both \code{targets}
and \code{reference} should be present in the \code{contrast_column}. These parameters
are similar to the \code{ident.1} and \code{ident.2} parameters in \code{FindMarkers}.
}
\section{Additional groups}{

The test is always computed between \code{targets} and \code{reference}, but it is possible
to add additional grouping variables with \code{group_vars}. If \code{group_vars} is used,
each comparison is split into groups defined by the \code{group_vars}. For instance, if we
have annotated cells into cell type populations and saved these annotations in a \code{meta.data}
column called "cell_type", we can pass "cell_type" to \code{group_vars="cell_type"} to split
tests across each cell type.
}

\section{Types of comparisons}{

Consider a scenario where we have a Seurat object (\code{seurat_object}) with PNA data.
\code{seurat_object} contains a \code{meta.data} column called "sampleID" that holds
information about what samples the PNA components originated from. This column could have
three sample IDs: "control", "stimulated1" and "stimulated2". In addition, we have a column
called "cell_type" that holds information about the cell type identity of each PNA component.
\enumerate{
\item If we want to compare the "stimulated1" group to the "control" group:
\preformatted{
daa_markers <- RunDAA(object = seurat_object,
                      contrast_column = "sampleID",
                      reference = "control",
                      targets = "stimulated1")
}
\item If we want to compare the "stimulated1" and "stimulated2" groups to the "control" group:
\preformatted{
daa_markers <- RunDAA(object = seurat_object,
                      contrast_column = "sampleID",
                      reference = "control",
                      targets = c("stimulated1", "stimulated2"))
}
\item If we want to compare the "stimulated1" and "stimulated2" groups to the "control" group, and split
the tests by cell type:
\preformatted{
daa_markers <- RunDAA(object = seurat_object,
                     contrast_column = "sampleID",
                     reference = "control",
                     targets = c("stimulated1", "stimulated2"),
                     group_vars = "cell_type")
}
}
}

\examples{
library(pixelatorR)
library(dplyr)
library(SeuratObject)

pxl_file <- minimal_mpx_pxl_file()
# Seurat objects
se <- ReadMPX_Seurat(pxl_file)
se <- merge(se, rep(list(se), 9), add.cell.ids = LETTERS[1:10])
se$sample <- c("T", "C", "C", "C", "C") \%>\% rep(times = 10)
se <- Seurat::NormalizeData(se \%>\% JoinLayers(), normalization.method = "CLR", margin = 2)

# Run DAA
daa_markers <- RunDAA(se,
  contrast_column = "sample",
  targets = "T", reference = "C"
)
daa_markers

}
\seealso{
Other DA-methods: 
\code{\link{DifferentialProximityAnalysis}()},
\code{\link{RunDCA}()},
\code{\link{RunDPA}()}
}
\concept{DA}
\concept{DA-methods}
