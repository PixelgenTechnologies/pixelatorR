% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generics.R, R/pivot_tables.R
\name{ColocalizationScoresToAssay}
\alias{ColocalizationScoresToAssay}
\alias{ColocalizationScoresToAssay.data.frame}
\alias{ColocalizationScoresToAssay.CellGraphAssay}
\alias{ColocalizationScoresToAssay.CellGraphAssay5}
\alias{ColocalizationScoresToAssay.Seurat}
\title{Convert colocalization scores to Assay}
\usage{
ColocalizationScoresToAssay(object, ...)

\method{ColocalizationScoresToAssay}{data.frame}(
  object,
  values_from = c("pearson_z", "pearson"),
  ...
)

\method{ColocalizationScoresToAssay}{CellGraphAssay}(
  object,
  values_from = c("pearson_z", "pearson"),
  ...
)

\method{ColocalizationScoresToAssay}{CellGraphAssay5}(
  object,
  values_from = c("pearson_z", "pearson"),
  ...
)

\method{ColocalizationScoresToAssay}{Seurat}(
  object,
  assay = NULL,
  new_assay = NULL,
  values_from = c("pearson_z", "pearson"),
  ...
)
}
\arguments{
\item{object}{An object with colocalization scores}

\item{...}{Not yet implemented}

\item{values_from}{What column to pick colocalization scores from. One of
"pearson", "pearson_mean", "pearson_z", "jaccard_mean", "jaccard" or "jaccard_z"}

\item{assay}{Name of the \code{\link{CellGraphAssay}} to pull polarization scores from}

\item{new_assay}{Name of the \code{Assay} to store the polarization scores in}
}
\description{
Convert colocalization scores to Assay
}
\section{Behavior}{


Takes an object with colocalization scores in long format and returns an
object with colocalization scores in a wide format. The colocalization score
table includes various colocalization scores along with p-values for each pair
markers and component.

The wide format is an array-like object with dimensions (markers_1 * marker_2) x components,
where each cell is filled with a polarization score. Scores that are missing
from the colocalization score table are replaced with 0's.

Different outputs are returned depending on the input object type:

\itemize{
\item{
\code{tibble/data.frame}: returns a matrix with marker pairs in rows and components
in columns
}
\item{
\code{CelGraphAssay}: returns an Assay with marker pairs in rows and
components in columns
}
\item{
\code{Seurat} object: returns the Seurat object with a new Assay
with marker pairs in rows and components in columns
}
}

As many functions provided in Seurat works on \code{Assay} objects, it is
sometimes convenient to make this conversion. For instance, if we want to
compute a UMAP on the colocalization scores with \code{RunUMAP}, we need the
values to be formatted in an \code{Assay}. This also makes it possible
to use various visualization functions such as \code{VlnPlot} or \code{FeaturePlor}
to show the distribution of colocalization scores.
}

\examples{
library(pixelatorR)
library(SeuratObject)
# Set arrow data output directory to temp for tests
options(pixelatorR.arrow_outdir = tempdir())

# Load example data as a Seurat object
pxl_file <- system.file("extdata/five_cells",
  "five_cells.pxl",
  package = "pixelatorR"
)
col_scores <- ReadMPX_colocalization(pxl_file)

# ColocalizationScoresToAssay returns a matrix for a tbl_df
col_scores_mat <- ColocalizationScoresToAssay(col_scores)
col_scores_mat[1:4, 1:5]

# Create a Seurat object
seur <- ReadMPX_Seurat(pxl_file, overwrite = TRUE)

# Fetch CellGraphAssay and create new polarization
# scores Assay
cg_assay <- seur[["mpxCells"]]
class(cg_assay)
col_assay <- ColocalizationScoresToAssay(cg_assay)
class(col_assay)

# Convert colocalization scores within a Seurat object
seur <- ColocalizationScoresToAssay(seur)

# After conversion, we now have a new assay called "colocalization"
seur[["colocalization"]]

# Switch default assay to polarization
DefaultAssay(seur) <- "colocalization"

# Visualize colocalization scores with Seurat
# VlnPlot(seur, features = "CD19") +
#   ggplot2::labs(y = "Colocalization score")

}
\seealso{
Other Spatial metrics conversion methods: 
\code{\link{PolarizationScoresToAssay}()}
}
\concept{Spatial metrics conversion methods}
