<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pixelatorR">
<title>Load data • pixelatorR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Load data">
<meta property="og:description" content="pixelatorR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pixelatorR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/introduction.html">Introduction</a>
    <a class="dropdown-item" href="../articles/load_data.html">Load Data</a>
    <a class="dropdown-item" href="../articles/subset_and_merge.html">Merge &amp; subset</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/PixelgenTechnologies/pixelatorR" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Load data</h1>
            
            <h4 data-toc-skip class="date">2023-12-18</h4>
      
      
      <div class="d-none name"><code>load_data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pixelgentechnologies.github.io/pixelatorR/" class="external-link">pixelatorR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mojaveazure.github.io/seurat-object/" class="external-link">SeuratObject</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>Tip: you can turn off the verbose messages in <code>pixelatorR</code>
by setting:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>pixelatorR.verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>In this tutorial, we will take a closer look at the functions that
<code>pixelatorR</code> provides to load data. This is mainly intended
for more advanced users. If you want to learn more about how to analyze
MPX data, please visit our <a href="https://software.pixelgen.com/mpx-analysis/introduction" class="external-link">tutorials</a>.</p>
</blockquote>
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>To get started, we need a <code>pxl</code> file which we can download
from <a href="https://software.pixelgen.com/" class="external-link uri">https://software.pixelgen.com/</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"PBMC_data"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://pixelgen-technologies-datasets.s3.eu-north-1.amazonaws.com/mpx-datasets/pixelator/0.12.0/1k-human-pbmcs-v1.0-immunology-I/Sample01_human_pbmcs_unstimulated.dataset.pxl?download=1"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"PBMC_data/Sample01_human_pbmcs_unstimulated.dataset.pxl"</span><span class="op">)</span></span></code></pre></div>
<p><code>pixelatorR</code> provides several functions to load data from
a <code>pxl</code> file.</p>
<p>For instance, <code>ReadMPX_counts</code> allows us to load only the
count matrix and nothing else:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pxl_file</span> <span class="op">&lt;-</span> <span class="st">"PBMC_data/Sample01_human_pbmcs_unstimulated.dataset.pxl"</span></span>
<span><span class="va">countMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReadMPX_counts.html">ReadMPX_counts</a></span><span class="op">(</span><span class="va">pxl_file</span><span class="op">)</span></span>
<span><span class="va">countMatrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##       RCVCMP0000000 RCVCMP0000002 RCVCMP0000003 RCVCMP0000005 RCVCMP0000006</span></span>
<span><span class="co">## CD274            62            11            25            31            16</span></span>
<span><span class="co">## CD44            553           180            66           347           213</span></span>
<span><span class="co">## CD25             12             7             6             8             5</span></span>
<span><span class="co">## CD279             4             2             0             8             2</span></span>
<span><span class="co">## CD41              6             1             3             5             6</span></span></code></pre>
<p>With <code>ReadMPX_item</code>, we can chose a specific item to load
from the <code>pxl</code> file, including: “polarization”,
“colocalization”, “edgelist”.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polarization_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReadMPX_item.html">ReadMPX_item</a></span><span class="op">(</span><span class="va">pxl_file</span>, items <span class="op">=</span> <span class="st">"polarization"</span><span class="op">)</span></span>
<span><span class="va">polarization_scores</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 33,479 × 6</span></span></span>
<span><span class="co">##     morans_i morans_p_value morans_p_adjusted morans_z marker component    </span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">99</span>          0.772              1.00   -<span style="color: #BB0000;">0.290</span>  ACTB   RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.016</span><span style="color: #BB0000; text-decoration: underline;">1</span>           0.177              0.771  -<span style="color: #BB0000;">1.35</span>   B2M    RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  0.014<span style="text-decoration: underline;">7</span>           0.125              0.633   1.53   CD102  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">78</span>          0.590              1.00   -<span style="color: #BB0000;">0.539</span>  CD11a  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  0.000<span style="text-decoration: underline;">836</span>         0.891              1.00    0.137  CD127  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">32</span>          0.145              0.693  -<span style="color: #BB0000;">1.46</span>   CD150  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">03</span>          0.395              1.00   -<span style="color: #BB0000;">0.851</span>  CD152  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">62</span>          0.036<span style="text-decoration: underline;">5</span>             0.265  -<span style="color: #BB0000;">2.09</span>   CD154  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">919</span>         0.971              1.00   -<span style="color: #BB0000;">0.036</span><span style="color: #BB0000; text-decoration: underline;">4</span> CD162  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">345</span>         0.561              1.00    0.582  CD163  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 33,469 more rows</span></span></span></code></pre>
<p>If we provide multiple items, <code>ReadMPX_item</code> returns a
list instead:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReadMPX_item.html">ReadMPX_item</a></span><span class="op">(</span><span class="va">pxl_file</span>, items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"polarization"</span>, <span class="st">"colocalization"</span>, <span class="st">"edgelist"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">all_items</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "polarization"   "colocalization" "edgelist"</span></span></code></pre>
<p>Alternatively, we can use the wrapper functions
<code>ReadMPX_polarization</code>, <code>ReadMPX_colocaliztion</code>
and <code>ReadMPX_edgelist</code> to do the same thing as
<code>ReadMPX_item</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polarization_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReadMPX_item.html">ReadMPX_polarization</a></span><span class="op">(</span><span class="va">pxl_file</span><span class="op">)</span></span></code></pre></div>
<p>is equivalent to</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polarization_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReadMPX_item.html">ReadMPX_item</a></span><span class="op">(</span><span class="va">pxl_file</span>, items <span class="op">=</span> <span class="st">"polarization"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="seurat">Seurat<a class="anchor" aria-label="anchor" href="#seurat"></a>
</h3>
<p>Perhaps the most useful function here is <code>ReadMPX_Seurat</code>
which allows us to load MPX data into a <code>Seurat</code> object with
some additional bells and whistles provided by
<code>pixelatorR</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReadMPX_Seurat.html">ReadMPX_Seurat</a></span><span class="op">(</span><span class="va">pxl_file</span><span class="op">)</span></span></code></pre></div>
<p>Here, you have a few options to modify how the <code>Seurat</code>
should be created. First and foremost, we can set
<code>return_cellgraphassay = FALSE</code> to return a
<code>Seurat</code> object which only includes abundance
measurements.</p>
<p>In this simpler data set, only the count matrix is stored as an
<code>Assay</code> without any spatial data. This means that almost all
information that is unique to MPX will be ignored so you will not be
able to analyze or visualize graphs and there will be no way to explore
the spatial statistics.</p>
<p>However, this basic data set uses significantly less memory and is
faster to process which can be useful if protein
<strong>abundance</strong> is the only interesting data type for the
analysis.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load simpler data set</span></span>
<span><span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReadMPX_Seurat.html">ReadMPX_Seurat</a></span><span class="op">(</span><span class="va">pxl_file</span>, return_cellgraphassay <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">seur_obj</span><span class="op">[[</span><span class="st">"mpxCells"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Assay data with 80 features for 477 cells</span></span>
<span><span class="co">## Top 10 variable features:</span></span>
<span><span class="co">##  CD274, CD44, CD25, CD279, CD41, HLA-ABC, CD54, CD26, CD27, CD38</span></span></code></pre>
<p>By default, <code>ReadMPX_Seurat</code> returns the MPX data in an
object called <code>CellGraphAssay</code>. This object class extends the
<code>Assay</code> class from Seurat and is essentially an
<code>Assay</code> object with additional data slots. The
<code>CellGraphAssay</code> class will be covered in more detail later
in this tutorial.</p>
<p>Most additional parameters in <code>ReadMPX_Seurat</code> controls
the behavior when <code>return_cellgraphassay = TRUE</code>. By default,
the MPX polarization scores and colocalization scores are loaded and
stored in a <code>CellGraphAssay</code> named “mpxCells”.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seur_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReadMPX_Seurat.html">ReadMPX_Seurat</a></span><span class="op">(</span><span class="va">pxl_file</span><span class="op">)</span></span>
<span><span class="va">seur_obj</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of class Seurat </span></span>
<span><span class="co">## 80 features across 477 samples within 1 assay </span></span>
<span><span class="co">## Active assay: mpxCells (80 features, 80 variable features)</span></span>
<span><span class="co">##  2 layers present: counts, data</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="spatial-metrics">Spatial metrics<a class="anchor" aria-label="anchor" href="#spatial-metrics"></a>
</h3>
<p>We can fetch the polarization/colocalization score tables from the
<code>Seurat</code> object with the <code>PolarizationScores</code> and
<code>ColocalizationScores</code> methods:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch polarization scores</span></span>
<span><span class="va">polarizaton_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PolarizationScores.html">PolarizationScores</a></span><span class="op">(</span><span class="va">seur_obj</span><span class="op">)</span></span>
<span><span class="va">polarizaton_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">##    morans_i morans_p_value morans_p_adjusted morans_z marker component    </span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.002</span><span style="color: #BB0000; text-decoration: underline;">99</span>           0.772             1.00    -<span style="color: #BB0000;">0.290</span> ACTB   RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.016</span><span style="color: #BB0000; text-decoration: underline;">1</span>            0.177             0.771   -<span style="color: #BB0000;">1.35</span>  B2M    RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  0.014<span style="text-decoration: underline;">7</span>            0.125             0.633    1.53  CD102  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">78</span>           0.590             1.00    -<span style="color: #BB0000;">0.539</span> CD11a  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>  0.000<span style="text-decoration: underline;">836</span>          0.891             1.00     0.137 CD127  RCVCMP0000830</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">32</span>           0.145             0.693   -<span style="color: #BB0000;">1.46</span>  CD150  RCVCMP0000830</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch colocalization scores</span></span>
<span><span class="va">colocalization_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ColocalizationScores.html">ColocalizationScores</a></span><span class="op">(</span><span class="va">seur_obj</span><span class="op">)</span></span>
<span><span class="va">colocalization_scores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 15</span></span></span>
<span><span class="co">##   marker_1 marker_2 pearson pearson_mean pearson_stdev pearson_z pearson_p_value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> ACTB     ACTB       1            1           0          <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> ACTB     B2M        0.324        0.317       0.016<span style="text-decoration: underline;">2</span>      0.429       0.334    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> B2M      B2M        1            1           0          <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> ACTB     CD102      0.304        0.235       0.016<span style="text-decoration: underline;">7</span>      4.17        0.000<span style="text-decoration: underline;">015</span>1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> B2M      CD102      0.604        0.614       0.009<span style="text-decoration: underline;">66</span>    -<span style="color: #BB0000;">1.06</span>        0.145    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> CD102    CD102      1            1           0          <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 8 more variables: pearson_p_value_adjusted &lt;dbl&gt;, jaccard &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   jaccard_mean &lt;dbl&gt;, jaccard_stdev &lt;dbl&gt;, jaccard_z &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   jaccard_p_value &lt;dbl&gt;, jaccard_p_value_adjusted &lt;dbl&gt;, component &lt;chr&gt;</span></span></span></code></pre>
<p>An equivalent way to extract the polarization scores would be:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polarizaton_scores</span> <span class="op">&lt;-</span> <span class="va">seur_obj</span><span class="op">[[</span><span class="st">"mpxCells"</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">polarization</span></span></code></pre></div>
<p>But it’s good practice to use
<code>PolarizationScores</code>/<code>ColocalizationScores</code> which
is easier to read. One just have to make sure that the
<code>DefaultAssay</code> is set to “mpxCells”.</p>
</div>
<div class="section level3">
<h3 id="qc-metrics">QC metrics<a class="anchor" aria-label="anchor" href="#qc-metrics"></a>
</h3>
<p>Component-specific metrics are stored in the <code>@meta.data</code>
slot of the <code>Seurat</code> object which can be accessed with double
brackets (<code>[[]]</code>):</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">seur_obj</span><span class="op">[[</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "antibodies"          "edges"               "leiden"             </span></span>
<span><span class="co">##  [4] "mean_reads"          "mean_umi_per_upia"   "mean_upia_degree"   </span></span>
<span><span class="co">##  [7] "median_reads"        "median_umi_per_upia" "median_upia_degree" </span></span>
<span><span class="co">## [10] "reads"               "tau"                 "tau_type"           </span></span>
<span><span class="co">## [13] "umi"                 "umi_per_upia"        "upia"               </span></span>
<span><span class="co">## [16] "upia_per_upib"       "upib"                "vertices"           </span></span>
<span><span class="co">## [19] "nCount_mpxCells"     "nFeature_mpxCells"</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seur_obj</span><span class="op">[[</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               antibodies edges leiden mean_reads mean_umi_per_upia</span></span>
<span><span class="co">## RCVCMP0000000         77 23925      2   6.099645          8.179487</span></span>
<span><span class="co">## RCVCMP0000002         72  6719      1   5.868135          3.857061</span></span>
<span><span class="co">## RCVCMP0000003         78  8596      5   5.960330          3.653209</span></span>
<span><span class="co">## RCVCMP0000005         79 17206      3   5.743520          4.782101</span></span>
<span><span class="co">## RCVCMP0000006         76 21254      2   5.510445          5.413653</span></span>
<span><span class="co">## RCVCMP0000007         69  6687      1   5.683565          5.195804</span></span>
<span><span class="co">##               mean_upia_degree median_reads median_umi_per_upia</span></span>
<span><span class="co">## RCVCMP0000000         3.134359            5                   5</span></span>
<span><span class="co">## RCVCMP0000002         2.191160            5                   3</span></span>
<span><span class="co">## RCVCMP0000003         2.002550            5                   2</span></span>
<span><span class="co">## RCVCMP0000005         2.540578            5                   3</span></span>
<span><span class="co">## RCVCMP0000006         2.461793            5                   3</span></span>
<span><span class="co">## RCVCMP0000007         2.732712            5                   3</span></span>
<span><span class="co">##               median_upia_degree  reads       tau tau_type   umi umi_per_upia</span></span>
<span><span class="co">## RCVCMP0000000                  2 145934 0.9832869   normal 23645     8.083761</span></span>
<span><span class="co">## RCVCMP0000002                  2  39428 0.9734463   normal  6703     3.847876</span></span>
<span><span class="co">## RCVCMP0000003                  1  51235 0.9825753   normal  8548     3.632809</span></span>
<span><span class="co">## RCVCMP0000005                  2  98823 0.9733801   normal 17034     4.734297</span></span>
<span><span class="co">## RCVCMP0000006                  2 117119 0.9864106   normal 21032     5.357106</span></span>
<span><span class="co">## RCVCMP0000007                  2  38006 0.9710634   normal  6667     5.180264</span></span>
<span><span class="co">##               upia upia_per_upib upib vertices nCount_mpxCells</span></span>
<span><span class="co">## RCVCMP0000000 2925      2.881773 1015     3940           23925</span></span>
<span><span class="co">## RCVCMP0000002 1742      2.927731  595     2337            6719</span></span>
<span><span class="co">## RCVCMP0000003 2353      3.994907  589     2942            8596</span></span>
<span><span class="co">## RCVCMP0000005 3598      2.784830 1292     4890           17206</span></span>
<span><span class="co">## RCVCMP0000006 3926      2.918959 1345     5271           21254</span></span>
<span><span class="co">## RCVCMP0000007 1287      2.508772  513     1800            6687</span></span>
<span><span class="co">##               nFeature_mpxCells</span></span>
<span><span class="co">## RCVCMP0000000                77</span></span>
<span><span class="co">## RCVCMP0000002                72</span></span>
<span><span class="co">## RCVCMP0000003                78</span></span>
<span><span class="co">## RCVCMP0000005                79</span></span>
<span><span class="co">## RCVCMP0000006                76</span></span>
<span><span class="co">## RCVCMP0000007                69</span></span></code></pre>
<p>We can for instance explore QC metrics visually for component
filtering:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">seur_obj</span><span class="op">[[</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">tau</span>, <span class="va">umi_per_upia</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">)</span></span></code></pre></div>
<p><img src="load_data_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="edge-list">Edge list<a class="anchor" aria-label="anchor" href="#edge-list"></a>
</h3>
<p>The edge list represents the raw MPX data where each row corresponds
to an edge formed between a UPIA and a UPIB pixel. This information is
rarely needed for analysis, but is required if we want to load and
explore component graphs.</p>
<p><code>ReadMPX_Seurat</code> doesn’t load the edge list in memory,
instead it creates a copy of the raw file (parquet) to a directory. The
path to this directory is stored in the <code>CellGraphAssay</code>
object and can be accessed with:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ArrowDir.html">ArrowDir</a></span><span class="op">(</span><span class="va">seur_obj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #0000BB; font-weight: bold;">./edgelists/5LJu5-2024-03-08-142913</span></span></span></code></pre>
<p>By default, a directory called <code>edgelists</code> is created in
the current working directory. Inside this directory, the edgelist is
stored in a sub directory with a unique name.</p>
<p>You can set the global option <code>pixelatorR.arrow_oudir</code> to
any existing directory. For instance, if you want to use a temporary
directory, you can use:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>pixelatorR.arrow_outdir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The downside with using a temporary directory is that it will be
cleared if the R session crashes or is restarted. On the flip side, you
don’t have to worry about cleaning up the edgelists directory which can
get cluttered when subsetting or merging data (see subset and merge
tutorial for more information).</p>
<p>Let’s take a closer look at the contents of the edge list
directory:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ArrowDir.html">ArrowDir</a></span><span class="op">(</span><span class="va">seur_obj</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #0000BB; font-weight: bold;">/Users/ludviglarsson/r-pixelator-packages/pixelatorR/vignettes/edgelists/5LJu5-2024-03-08-142913</span></span></span>
<span><span class="co">## └── <span style="color: #0000BB; font-weight: bold;">sample=S1</span></span></span>
<span><span class="co">##     └── edgelist.parquet</span></span></code></pre>
<p>The sub directory of the edgelists directory contains a folder called
“sample=S1” with the edge list file for our data set.</p>
<p>The <code>arrow</code> R package makes it easy to access data from
our edge list file. Please take a look at their <a href="https://arrow.apache.org/docs/r/" class="external-link">package website</a> for more
details.</p>
<p>Our <code>CellGraphAssay</code> keeps a
<code>FileSystemDataset</code> object which we can use to load edge list
data in memory when needed. For example, we can extract the top 10 rows
with:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ArrowData.html">ArrowData</a></span><span class="op">(</span><span class="va">seur_obj</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 10</span></span></span>
<span><span class="co">##    upia      upib  umi   marker sequence count umi_unique_count upi_unique_count</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> ATTAGAAG… TATA… GCGT… CD48   GACCACTC    28                1                1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> TTAACATA… CGAT… ACTG… CD48   GACCACTC    26                1                1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> AAAAATAC… GGTC… GCAG… CD48   GACCACTC    26                1                1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> ATTTGTTT… TGTT… AGAT… CD48   GACCACTC    26                1                2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> TTTAGCGT… GTGC… CTCC… CD48   GACCACTC    25                1                2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> ACTTCGTT… GTCA… AACG… CD48   GACCACTC    25                1                3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> CCAAATTC… TAGT… GTAC… CD48   GACCACTC    25                1                1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> GTGAACAA… TCCT… TTAA… CD48   GACCACTC    24                1                1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> GAAGATAT… AAGC… TGCA… CD48   GACCACTC    24                1                1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> ACCGGACA… GGAT… ACTT… CD48   GACCACTC    24                1                1</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 more variables: component &lt;chr&gt;, sample &lt;chr&gt;</span></span></span></code></pre>
<p>Note that the <code>collect</code> verb is required to load the data
in memory as a <code>tbl_df</code> (tibble) object.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>© Pixelgen Technologies 2024 | <a href="https://www.pixelgen.com/cookie-policy/" class="external-link">About cookies</a> | <a href="https://www.pixelgen.com/privacy-policy/" class="external-link">Privacy policy</a></p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
