<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a rotating 3D layout video — render_rotating_layout • pixelatorR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a rotating 3D layout video — render_rotating_layout"><meta name="description" content="
render_rotating_layout can be used to generate a rotating 3D scatter
plot from a tibble with node layout coordinates. render_rotating_layout
offers a number of customization options, including the option to facet the
plot by additional columns in the tibble. See the sections below for more details
on how to adjust the appearance."><meta property="og:description" content="
render_rotating_layout can be used to generate a rotating 3D scatter
plot from a tibble with node layout coordinates. render_rotating_layout
offers a number of customization options, including the option to facet the
plot by additional columns in the tibble. See the sections below for more details
on how to adjust the appearance."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pixelatorR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.13.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/load_data.html">Load Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PixelgenTechnologies/pixelatorR" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a rotating 3D layout video</h1>

      <div class="d-none name"><code>render_rotating_layout.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p><code>render_rotating_layout</code> can be used to generate a rotating 3D scatter
plot from a tibble with node layout coordinates. <code>render_rotating_layout</code>
offers a number of customization options, including the option to facet the
plot by additional columns in the tibble. See the sections below for more details
on how to adjust the appearance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">render_rotating_layout</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">file</span>,</span>
<span>  cell_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  marker_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pt_opacity <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  pt_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  colors <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"Blues"</span><span class="op">)</span>,</span>
<span>  max_degree <span class="op">=</span> <span class="fl">360</span>,</span>
<span>  center_zero <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale_layout <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  frames <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  pad <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  show_first_frame <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  delay <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">20</span>,</span>
<span>  ggplot_theme <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="st">""</span>,</span>
<span>  bg <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  label_grid_axes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  margin_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  use_facet_grid <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  flip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  graphics_use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"base"</span>, <span class="st">"ggplot2"</span><span class="op">)</span>,</span>
<span>  boomerang <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep_frames <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A tibble (<code>tbl_df</code>) with columns 'x', 'y', 'z',
and 'node_val'. The 'node_val' column can be either a numeric or a
factor.</p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>A character string specifying the path to the output file.
The video format will be determined by the file extension. If the extension is
'.gif', the <code>gifski</code> R package will be used to render a gif. Other file
formats (such as mp4, mkv, mov, or flv) will be rendered using the <code>av</code>
R package. Make sure to use a file format supported by either <code>gifski</code>
or <code>av</code>.</p></dd>


<dt id="arg-cell-col-marker-col">cell_col, marker_col<a class="anchor" aria-label="anchor" href="#arg-cell-col-marker-col"></a></dt>
<dd><p>A character string specifying columns to facet the
plot by. <code>cell_col</code> should be a column with unique cell identifiers
and <code>marker_col</code> should be a column with unique protein identifiers.</p></dd>


<dt id="arg-pt-opacity">pt_opacity<a class="anchor" aria-label="anchor" href="#arg-pt-opacity"></a></dt>
<dd><p>A numeric value between 0 and 1 specifying the opacity
of the points.</p></dd>


<dt id="arg-pt-size">pt_size<a class="anchor" aria-label="anchor" href="#arg-pt-size"></a></dt>
<dd><p>A numeric value indicating the maximum size of the points.</p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>A vector of valid colors. If 'node_val' is a factor,
the length of 'colors' should be equal to the number of unique levels.
If 'node_val' is numeric, the colors will be used to create a gradient
color scale.</p></dd>


<dt id="arg-max-degree">max_degree<a class="anchor" aria-label="anchor" href="#arg-max-degree"></a></dt>
<dd><p>A numeric value between 90 and 360. The maximum angle
of rotation around the z axis. Default is 360, which corresponds to a
full turn around the z axis.</p></dd>


<dt id="arg-center-zero">center_zero<a class="anchor" aria-label="anchor" href="#arg-center-zero"></a></dt>
<dd><p>A logical value indicating whether the color gradient
should be centered around zero.</p></dd>


<dt id="arg-scale-layout">scale_layout<a class="anchor" aria-label="anchor" href="#arg-scale-layout"></a></dt>
<dd><p>A logical value indicating whether the layouts should be
such that they all fit the same bounding box. This is typically necessary
as layouts vary significantly in size.</p></dd>


<dt id="arg-frames">frames<a class="anchor" aria-label="anchor" href="#arg-frames"></a></dt>
<dd><p>A positive numeric value indicating the number of frames
to render. More frames will result in a smoother animation but will
increase the size of the output file and rendering time.</p></dd>


<dt id="arg-pad">pad<a class="anchor" aria-label="anchor" href="#arg-pad"></a></dt>
<dd><p>A numeric value between 0 and 1. The amount of padding to add
to the axis range. Default is 0.1 which corresponds to an expansion of 10%
along all three axes.</p></dd>


<dt id="arg-show-first-frame">show_first_frame<a class="anchor" aria-label="anchor" href="#arg-show-first-frame"></a></dt>
<dd><p>A logical value indicating whether the first frame
should be displayed in the viewer before proceeding with the rendering. In
interactive sessions, you will be prompted to enter 'Yes' to continue if you
are satisfied with the first frame. Default is TRUE.</p></dd>


<dt id="arg-width-height">width, height<a class="anchor" aria-label="anchor" href="#arg-width-height"></a></dt>
<dd><p>An integer specifying the width and height of the
video in pixels. Default is 500x500 which is suitable for a low resolution
GIF file.</p></dd>


<dt id="arg-res">res<a class="anchor" aria-label="anchor" href="#arg-res"></a></dt>
<dd><p>A numeric value indicating the resolution of the png files in dpi.
See <code><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></code> for more details.</p></dd>


<dt id="arg-delay">delay<a class="anchor" aria-label="anchor" href="#arg-delay"></a></dt>
<dd><p>A numeric value indicating the delay between frames in seconds.
Default is 1/20, which corresponds to 20 frames per second. The value should
be between 1/100 and 1.</p></dd>


<dt id="arg-ggplot-theme">ggplot_theme<a class="anchor" aria-label="anchor" href="#arg-ggplot-theme"></a></dt>
<dd><p>A ggplot2 theme object. Default is <code>NULL</code>, which
corresponds to the default plot theme.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>A character string specifying the title of the plot.</p></dd>


<dt id="arg-bg">bg<a class="anchor" aria-label="anchor" href="#arg-bg"></a></dt>
<dd><p>A valid color string specifying the background color of the plot.</p></dd>


<dt id="arg-label-grid-axes">label_grid_axes<a class="anchor" aria-label="anchor" href="#arg-label-grid-axes"></a></dt>
<dd><p>A logical value indicating whether the rows and columns of
the plot grid should be labeled.</p></dd>


<dt id="arg-margin-widths">margin_widths<a class="anchor" aria-label="anchor" href="#arg-margin-widths"></a></dt>
<dd><p>A numeric vector of length 2 specifying the width of the
left and top margins relative to the width and height of the plot. Default is
c(0.1, 0.1), meaning that the left and top margins will take up 10% of the
width and height respectively.</p></dd>


<dt id="arg-use-facet-grid">use_facet_grid<a class="anchor" aria-label="anchor" href="#arg-use-facet-grid"></a></dt>
<dd><p>If set to TRUE, the plot will be faceted using
<code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></code>. Note that with this option, the node
colors will be mapped to a single color scale. If these selected markers
have very different dynamic ranges, it might be difficult to observe trends
in lowly expressed markers.</p></dd>


<dt id="arg-flip">flip<a class="anchor" aria-label="anchor" href="#arg-flip"></a></dt>
<dd><p>A logical value indicating whether the plot should be flipped
such that markers are arranged in columns and cells in rows.</p></dd>


<dt id="arg-graphics-use">graphics_use<a class="anchor" aria-label="anchor" href="#arg-graphics-use"></a></dt>
<dd><p>One of "ggplot2" or "base". The default, "base", is much
faster but has fewer customization options. The "ggplot2" option
comes with a number of customization options.</p></dd>


<dt id="arg-boomerang">boomerang<a class="anchor" aria-label="anchor" href="#arg-boomerang"></a></dt>
<dd><p>A logical value specifying whether the rotation should
be reversed after reaching the maximum degree to create a "boomerang" effect.
The frames are simply reversed and appended to the original frames.
The resulting video will have twice as many frames as specified by the
<code>frames</code> argument and keep the same frame rate. Note that if the output
is a gif file, it will double in size.</p></dd>


<dt id="arg-cl">cl<a class="anchor" aria-label="anchor" href="#arg-cl"></a></dt>
<dd><p>A number of threads or a cluster object created by
<code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></code>. The default is <code>NULL</code>, which
corresponds to a single-threaded operation (sequential processing).</p></dd>


<dt id="arg-keep-frames">keep_frames<a class="anchor" aria-label="anchor" href="#arg-keep-frames"></a></dt>
<dd><p>A logical value indicating whether the png files should
be kept after rendering the video. This option is useful if you want to
access to the individual frames later for further processing.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Exports an animation of a rotating 3D scatter plot.</p>
    </div>
    <div class="section level2">
    <h2 id="cells-and-markers">cells and markers<a class="anchor" aria-label="anchor" href="#cells-and-markers"></a></h2>


<p>The <code>cell_col</code> and <code>marker_col</code> arguments can be used to facet
the plot by additional columns in the tibble. For instance, if the tibble
contains layout coordinates for multiple cells and markers, two additional
columns should specify these groupings. In the final plot, each cell will
plotted in its own coordinate system to make sure that the layout fills
the plot area. Similarly, each marker will share the same color scale to make
sure that the colors are comparable across cells.</p>
    </div>
    <div class="section level2">
    <h2 id="graphic-parameters">graphic parameters<a class="anchor" aria-label="anchor" href="#graphic-parameters"></a></h2>


<p>The appearance of the plot can be customized using a number of graphics
parameters. Increasing the number of <code>frames</code> while decreasing the
delay will create a smoother transition but will take much longer to render.
The <code>width</code> and <code>height</code> parameters should be increased manually
to accommodate more cells and markers or to increase resolution.
The <code>width</code> and <code>height</code> parameters should be adjusted to match
the selected dpi (<code>res</code>). Note that when these parameters are increased,
the rendering time can increase drastically. Unfortunately, drawing ggplot
objects to the graphics device is relatively slow so the rendering might take
several minutes. Using base R graphics instead of ggplot2 can speed up the
rendering significantly, but it will limit the customization options.</p>
<p>Since the rendering is expensive, we might want to inspect the first frame to
make sure that the plot looks as expected. If the <code>show_first_frame</code> argument
is set to <code>TRUE</code>, which is the default, the first frame will be displayed
in the viewer before proceeding with the rendering. In interactive sessions,
you will be prompted to enter 'Yes' to continue if you are satisfied with the
first frame.</p>
    </div>
    <div class="section level2">
    <h2 id="parallel-processing">parallel processing<a class="anchor" aria-label="anchor" href="#parallel-processing"></a></h2>


<p>To speed up the rendering, the <code>cl</code> argument can be used to specify a
number of threads. This feature only works on unix-based systems.
This can significantly reduce the rendering time; however, it might create
artefacts in the output video. The default is <code>NULL</code>, which corresponds
to a single-threaded operation (sequential processing).</p>
    </div>
    <div class="section level2">
    <h2 id="graphics-use">graphics_use<a class="anchor" aria-label="anchor" href="#graphics-use"></a></h2>


<p>The <code>graphics_use</code> argument can be used to switch between the default
"base" and the "ggplot2" graphics system. The "base" option is much faster
but has fewer customization options. For instance, it is currently not possible to
get row and column labels with the "base" graphics option.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pxl_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="pna_dataset.html">minimal_pna_pxl_file</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="ReadPNA_Seurat.html">ReadPNA_Seurat</a></span><span class="op">(</span><span class="va">pxl_file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="va">se</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="LoadCellGraphs.html">LoadCellGraphs</a></span><span class="op">(</span>add_layouts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a gif from a 3D layout</span></span></span>
<span class="r-in"><span><span class="va">cg</span> <span class="op">&lt;-</span> <span class="fu"><a href="CellGraphs.html">CellGraphs</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">cg</span><span class="op">@</span><span class="va">layout</span><span class="op">$</span><span class="va">wpmds_3d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>node_val <span class="op">=</span> <span class="va">cg</span><span class="op">@</span><span class="va">counts</span><span class="op">[</span>, <span class="st">"CD3e"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">temp_gif</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_temp.html" class="external-link">file_temp</a></span><span class="op">(</span>ext <span class="op">=</span> <span class="st">".gif"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">render_rotating_layout</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="va">temp_gif</span>,</span></span>
<span class="r-in"><span>  colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lightgrey"</span>, <span class="st">"red"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pt_size <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  max_degree <span class="op">=</span> <span class="fl">90</span>,</span></span>
<span class="r-in"><span>  frames <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  delay <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  bg <span class="op">=</span> <span class="st">"transparent"</span>,</span></span>
<span class="r-in"><span>  label_grid_axes <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  show_first_frame <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> The following parameters are not supported with graphics_use = 'base':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ggplot_theme, label_grid_axes, title</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Titles, text annotations and color bar will be missing from the plot.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── Rendering frames... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── Creating video... </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> The video has been saved to:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> /var/folders/gw/bdcqhnvs0m9gs_mq8n51jtbc0000gn/T/RtmpoNg3om/fileb696473b525e.gif</span>
<span class="r-in"><span><span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_read</a></span><span class="op">(</span><span class="va">temp_gif</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    format width height colorspace matte filesize density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> GIF      500    500 sRGB       TRUE         0 +72x+72</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Include multiple facets</span></span></span>
<span class="r-in"><span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Marker"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">cg</span> <span class="op">&lt;-</span> <span class="fu">simulate_bipartite_graph</span><span class="op">(</span>n_nodes <span class="op">=</span> <span class="fl">5e3</span>, epsilon <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">add_binary_marker_counts_pol</span><span class="op">(</span>marker_polarize <span class="op">=</span> <span class="st">"Marker1"</span>, epsilon <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">xyz</span> <span class="op">&lt;-</span> <span class="fu"><a href="layout_with_weighted_pmds.html">layout_with_weighted_pmds</a></span><span class="op">(</span><span class="va">cg</span><span class="op">@</span><span class="va">cellgraph</span>, dim <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>.name_repair <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cg</span><span class="op">@</span><span class="va">counts</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">xyz</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>node_val <span class="op">=</span> <span class="va">cg</span><span class="op">@</span><span class="va">counts</span><span class="op">[</span>, <span class="va">m</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>marker <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cell <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Cell"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">temp_gif</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_temp.html" class="external-link">file_temp</a></span><span class="op">(</span>ext <span class="op">=</span> <span class="st">".gif"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">render_rotating_layout</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>  pt_size <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  width <span class="op">=</span> <span class="fl">740</span>,</span></span>
<span class="r-in"><span>  height <span class="op">=</span> <span class="fl">650</span>,</span></span>
<span class="r-in"><span>  cell_col <span class="op">=</span> <span class="st">"cell"</span>,</span></span>
<span class="r-in"><span>  marker_col <span class="op">=</span> <span class="st">"marker"</span>,</span></span>
<span class="r-in"><span>  colors <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="va">temp_gif</span>,</span></span>
<span class="r-in"><span>  max_degree <span class="op">=</span> <span class="fl">90</span>,</span></span>
<span class="r-in"><span>  frames <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  delay <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  res <span class="op">=</span> <span class="fl">150</span>,</span></span>
<span class="r-in"><span>  bg <span class="op">=</span> <span class="st">"grey"</span>,</span></span>
<span class="r-in"><span>  show_first_frame <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  cl <span class="op">=</span> <span class="fl">9</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_read</a></span><span class="op">(</span><span class="va">temp_gif</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use base R graphics</span></span></span>
<span class="r-in"><span><span class="va">temp_gif</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_temp.html" class="external-link">file_temp</a></span><span class="op">(</span>ext <span class="op">=</span> <span class="st">".gif"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">render_rotating_layout</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df</span>,</span></span>
<span class="r-in"><span>  pt_size <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  pt_opacity <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  width <span class="op">=</span> <span class="fl">740</span>,</span></span>
<span class="r-in"><span>  height <span class="op">=</span> <span class="fl">650</span>,</span></span>
<span class="r-in"><span>  cell_col <span class="op">=</span> <span class="st">"cell"</span>,</span></span>
<span class="r-in"><span>  marker_col <span class="op">=</span> <span class="st">"marker"</span>,</span></span>
<span class="r-in"><span>  colors <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  file <span class="op">=</span> <span class="va">temp_gif</span>,</span></span>
<span class="r-in"><span>  max_degree <span class="op">=</span> <span class="fl">360</span>,</span></span>
<span class="r-in"><span>  frames <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>  delay <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  res <span class="op">=</span> <span class="fl">150</span>,</span></span>
<span class="r-in"><span>  bg <span class="op">=</span> <span class="st">"grey"</span>,</span></span>
<span class="r-in"><span>  show_first_frame <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  graphics_use <span class="op">=</span> <span class="st">"base"</span>,</span></span>
<span class="r-in"><span>  cl <span class="op">=</span> <span class="fl">9</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_read</a></span><span class="op">(</span><span class="va">temp_gif</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>© Pixelgen Technologies 2024 | <a href="https://www.pixelgen.com/cookie-policy/" class="external-link">About cookies</a> | <a href="https://www.pixelgen.com/privacy-policy/" class="external-link">Privacy policy</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

