<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Identify population-specific markers for patch detection — identify_markers_for_patch_analysis • pixelatorR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify population-specific markers for patch detection — identify_markers_for_patch_analysis"><meta name="description" content="Patch detection can be applied to identify patches of one cell type
on another. The prerequisite for this analysis is that the patch-specific
markers are known. Patch detection can be improved further by also leveraging
receiver-specific markers. This function identifies population-specific markers
for the patch and receiver populations, which can then be used for patch detection."><meta property="og:description" content="Patch detection can be applied to identify patches of one cell type
on another. The prerequisite for this analysis is that the patch-specific
markers are known. Patch detection can be improved further by also leveraging
receiver-specific markers. This function identifies population-specific markers
for the patch and receiver populations, which can then be used for patch detection."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pixelatorR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.13.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/load_data.html">Load Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PixelgenTechnologies/pixelatorR" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Identify population-specific markers for patch detection</h1>

      <div class="d-none name"><code>identify_markers_for_patch_analysis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Patch detection can be applied to identify patches of one cell type
on another. The prerequisite for this analysis is that the patch-specific
markers are known. Patch detection can be improved further by also leveraging
receiver-specific markers. This function identifies population-specific markers
for the patch and receiver populations, which can then be used for patch detection.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">identify_markers_for_patch_analysis</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">group_by</span>,</span>
<span>  <span class="va">receiver_population</span>,</span>
<span>  <span class="va">target_population</span>,</span>
<span>  abundance_difference <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  min_freq <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  show_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <code>Seurat</code> object</p></dd>


<dt id="arg-group-by">group_by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>A string specifying the metadata column to group by</p></dd>


<dt id="arg-receiver-population">receiver_population<a class="anchor" aria-label="anchor" href="#arg-receiver-population"></a></dt>
<dd><p>A string specifying the receiver population name
present in the <code>group_by</code> column</p></dd>


<dt id="arg-target-population">target_population<a class="anchor" aria-label="anchor" href="#arg-target-population"></a></dt>
<dd><p>A string specifying the target population name
present in the <code>group_by</code> column</p></dd>


<dt id="arg-abundance-difference">abundance_difference<a class="anchor" aria-label="anchor" href="#arg-abundance-difference"></a></dt>
<dd><p>A numeric value specifying how many times
higher the abundance of a marker should be in one population relative
to the other. This is only used to label the markers in the output.</p></dd>


<dt id="arg-min-freq">min_freq<a class="anchor" aria-label="anchor" href="#arg-min-freq"></a></dt>
<dd><p>A numeric value specifying the minimum frequency of
a protein to be labeled in the output table.</p></dd>


<dt id="arg-show-plot">show_plot<a class="anchor" aria-label="anchor" href="#arg-show-plot"></a></dt>
<dd><p>Logical, whether to show a plot summarizing the results.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An integer seed for reproducibility</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>tbl_df</code> with the following columns:</p><ul><li><p><code>marker</code>: the name of the protein.</p></li>
<li><p><code>receiver_unmixed_freq</code>: the estimated proportion in the receiver population after unmixing.</p></li>
<li><p><code>target_unmixed_freq</code>: the estimated proportion in the target population after unmixing.</p></li>
<li><p><code>receiver_freq</code>: the proportion in the receiver population.</p></li>
<li><p><code>target_freq</code>: the proportion in the target population.</p></li>
<li><p><code>label</code>: a label indicating whether the protein is a marker for the receiver
or target population. NA values indicate that the protein is unspecific.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Patch detection is sensitive to the selection of markers and therefore requires
careful selection. The best markers are both high-abundant and specific to a
cell population.</p>
<p>The method requires a <code>Seurat</code> object with a metadata column containing
the population information, e.g. a column with cell type labels. We then need
to specify the receiver and target populations, where the receiver population represent
the cells on which the patches are expected to be found and the target population
represents the cell type from which the patches originated.</p>
<p>As a practical example, let's say that our data represent co-cultured T and B cells,
and we anticipate that the T cells have patches of B cells on them. Now we face a
challenge because the T cell population contains a lot of B cell markers, making it
harder to determine what markers are T-cell specific. In other words, the abundance
data is mixed.</p>
<p>This method attempts to unmix the abundance data using matrix factorization, estimating
the composition of the pure receiver and target populations. The unmixed abundance profiles
are then used to label population-specific markers based on the difference in abundance
and minimum frequency. The results are summarized in a table, and an optional plot is drawn
to help interpret the results.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>© Pixelgen Technologies 2024 | <a href="https://www.pixelgen.com/cookie-policy/" class="external-link">About cookies</a> | <a href="https://www.pixelgen.com/privacy-policy/" class="external-link">Privacy policy</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

