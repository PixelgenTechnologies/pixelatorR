<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Predict doublets in a Seurat object — PredictDoublets • pixelatorR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict doublets in a Seurat object — PredictDoublets"><meta name="description" content="
Predict doublets in a Seurat object by simulating doublets. Doublet detection
can be used to identify cell-cell aggregates or technical doublet artefacts in
single-cell omics data.
Both real and simulated cells are used to perform PCA and a nearest neighbor
search is performed to find the number of doublets in the neighborhood of
each cell.
The expected doublet rate is calculated based on the simulation rate and
the number of nearest neighbors. A binomial test is performed to test if
the number of doublets in the neighborhood of each cell is significantly
different from the expected doublet rate. The algorithm is inspired by the
DoubletFinder algorithm by McGinnis et al. (2019).
This method of doublet detection assumes that a doublet attains a composite
identity of the two cells that form it, i.e. that a doublet constitutes the
sum of its parts. This may not always the case, as cell-cell aggregates could
have molecular profiles that are different from the two cells that form them.
Furthermore, if the two cells that form a doublet are of the same or similar
identity, the doublet may not be detected as a doublet. This is a limitation
of the method and should be taken into account when interpreting the results."><meta property="og:description" content="
Predict doublets in a Seurat object by simulating doublets. Doublet detection
can be used to identify cell-cell aggregates or technical doublet artefacts in
single-cell omics data.
Both real and simulated cells are used to perform PCA and a nearest neighbor
search is performed to find the number of doublets in the neighborhood of
each cell.
The expected doublet rate is calculated based on the simulation rate and
the number of nearest neighbors. A binomial test is performed to test if
the number of doublets in the neighborhood of each cell is significantly
different from the expected doublet rate. The algorithm is inspired by the
DoubletFinder algorithm by McGinnis et al. (2019).
This method of doublet detection assumes that a doublet attains a composite
identity of the two cells that form it, i.e. that a doublet constitutes the
sum of its parts. This may not always the case, as cell-cell aggregates could
have molecular profiles that are different from the two cells that form them.
Furthermore, if the two cells that form a doublet are of the same or similar
identity, the doublet may not be detected as a doublet. This is a limitation
of the method and should be taken into account when interpreting the results."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pixelatorR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.13.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/load_data.html">Load Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PixelgenTechnologies/pixelatorR" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Predict doublets in a Seurat object</h1>

      <div class="d-none name"><code>PredictDoublets.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>Predict doublets in a Seurat object by simulating doublets. Doublet detection
can be used to identify cell-cell aggregates or technical doublet artefacts in
single-cell omics data.</p>
<p>Both real and simulated cells are used to perform PCA and a nearest neighbor
search is performed to find the number of doublets in the neighborhood of
each cell.
The expected doublet rate is calculated based on the simulation rate and
the number of nearest neighbors. A binomial test is performed to test if
the number of doublets in the neighborhood of each cell is significantly
different from the expected doublet rate. The algorithm is inspired by the
DoubletFinder algorithm by McGinnis et al. (2019).</p>
<p>This method of doublet detection assumes that a doublet attains a composite
identity of the two cells that form it, i.e. that a doublet constitutes the
sum of its parts. This may not always the case, as cell-cell aggregates could
have molecular profiles that are different from the two cells that form them.
Furthermore, if the two cells that form a doublet are of the same or similar
identity, the doublet may not be detected as a doublet. This is a limitation
of the method and should be taken into account when interpreting the results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PredictDoublets</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'Matrix'</span></span>
<span><span class="fu">PredictDoublets</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  ref_cells1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref_cells2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  simulation_rate <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_neighbor <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  npcs <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  p_adjust_method <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  p_threshold <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">37</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'Seurat'</span></span>
<span><span class="fu">PredictDoublets</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  ref_cells1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref_cells2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  simulation_rate <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_neighbor <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  npcs <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  p_adjust_method <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  p_threshold <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">37</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <code>Seurat</code> object or a count matrix.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments. Currently not used.</p></dd>


<dt id="arg-ref-cells-ref-cells-">ref_cells1, ref_cells2<a class="anchor" aria-label="anchor" href="#arg-ref-cells-ref-cells-"></a></dt>
<dd><p>A character vector with cell names or indices
to use as the first and second reference
populations. If NULL, all cells are used.</p></dd>


<dt id="arg-simulation-rate">simulation_rate<a class="anchor" aria-label="anchor" href="#arg-simulation-rate"></a></dt>
<dd><p>The rate of doublets to simulate. E.g. 3 means that
for each real cell, 3 doublets are simulated.</p></dd>


<dt id="arg-n-neighbor">n_neighbor<a class="anchor" aria-label="anchor" href="#arg-n-neighbor"></a></dt>
<dd><p>The number of nearest neighbors to use for the doublet
prediction. Default is 100.</p></dd>


<dt id="arg-npcs">npcs<a class="anchor" aria-label="anchor" href="#arg-npcs"></a></dt>
<dd><p>The number of principal components to use for PCA. Default is 10.</p></dd>


<dt id="arg-p-adjust-method">p_adjust_method<a class="anchor" aria-label="anchor" href="#arg-p-adjust-method"></a></dt>
<dd><p>The p-value adjustment method to use. Default is "BH".</p></dd>


<dt id="arg-p-threshold">p_threshold<a class="anchor" aria-label="anchor" href="#arg-p-threshold"></a></dt>
<dd><p>The p-value threshold to use. Default is 0.01.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>The seed to use for reproducibility.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Print messages.</p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>A character with the name of the assay to use.</p></dd>


<dt id="arg-layer">layer<a class="anchor" aria-label="anchor" href="#arg-layer"></a></dt>
<dd><p>A character with the name of the layer to use. Default is "counts".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>McGinnis CS, Murrow LM, Gartner ZJ.
DoubletFinder: Doublet Detection in Single-Cell RNA Sequencing Data
Using Artificial Nearest Neighbors. Cell Syst.
2019 Apr 24;8(4):329-337.e4. doi: 10.1016/j.cels.2019.03.003.
Epub 2019 Apr 3. PMID: 30954475; PMCID: PMC6853612.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>© Pixelgen Technologies 2024 | <a href="https://www.pixelgen.com/cookie-policy/" class="external-link">About cookies</a> | <a href="https://www.pixelgen.com/privacy-policy/" class="external-link">Privacy policy</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

