<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Automatic annotation of cell types — AnnotateCells • pixelatorR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Automatic annotation of cell types — AnnotateCells"><meta name="description" content="This function finds anchors in a reference dataset and transfers the cell type
of the reference to a query Seurat dataset. Two columns of cell type annotations
are added to the metadata of the query dataset, one high-level and one more
fine-grained. In addition, one can optionally summarize these annotations
for a specific clustering solution. When choosing this, the most common annotation
per cluster is added to the metadata of the object."><meta property="og:description" content="This function finds anchors in a reference dataset and transfers the cell type
of the reference to a query Seurat dataset. Two columns of cell type annotations
are added to the metadata of the query dataset, one high-level and one more
fine-grained. In addition, one can optionally summarize these annotations
for a specific clustering solution. When choosing this, the most common annotation
per cluster is added to the metadata of the object."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pixelatorR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.15.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/load_data.html">Load Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PixelgenTechnologies/pixelatorR" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Automatic annotation of cell types</h1>

      <div class="d-none name"><code>AnnotateCells.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function finds anchors in a reference dataset and transfers the cell type
of the reference to a query Seurat dataset. Two columns of cell type annotations
are added to the metadata of the query dataset, one high-level and one more
fine-grained. In addition, one can optionally summarize these annotations
for a specific clustering solution. When choosing this, the most common annotation
per cluster is added to the metadata of the object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AnnotateCells</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  reference <span class="op">=</span> <span class="va">reference</span>,</span>
<span>  summarize_by_column <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reference_assay <span class="op">=</span> <span class="st">"ADT"</span>,</span>
<span>  query_assay <span class="op">=</span> <span class="st">"PNA"</span>,</span>
<span>  reference_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"celltype.l1"</span>, <span class="st">"celltype.l2"</span><span class="op">)</span>,</span>
<span>  normalization_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LogNormalize"</span>, <span class="st">"SCT"</span>, <span class="st">"CLR"</span><span class="op">)</span>,</span>
<span>  reduction <span class="op">=</span> <span class="st">"cca"</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Seurat"</span>, <span class="st">"nmf"</span><span class="op">)</span>,</span>
<span>  min_prediction_score <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  skip_normalization <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>Seurat object to which you want to add celltype annotation</p></dd>


<dt id="arg-reference">reference<a class="anchor" aria-label="anchor" href="#arg-reference"></a></dt>
<dd><p>Seurat object that contains annotated reference data, see examples
for a programmatic way to obtain a PBMC reference dataset</p></dd>


<dt id="arg-summarize-by-column">summarize_by_column<a class="anchor" aria-label="anchor" href="#arg-summarize-by-column"></a></dt>
<dd><p>If NULL, return only the cell type annotation per cell.
If the name of a column in the object metadata is provided, the annotations will
be summarized to the factors of this column, i.e. the most common annotation per
factor level will be retained. Useful for annotating the output of the Seurat
clustering, for example.</p></dd>


<dt id="arg-reference-assay">reference_assay<a class="anchor" aria-label="anchor" href="#arg-reference-assay"></a></dt>
<dd><p>Assay in the reference dataset used to find the anchors,
Default: 'ADT'</p></dd>


<dt id="arg-query-assay">query_assay<a class="anchor" aria-label="anchor" href="#arg-query-assay"></a></dt>
<dd><p>Assay in the query dataset used to find the anchors. It should
probably be set to a normalized assay that was run on the object (e.g. "dsb"),
Default: 'PNA'</p></dd>


<dt id="arg-reference-groups">reference_groups<a class="anchor" aria-label="anchor" href="#arg-reference-groups"></a></dt>
<dd><p>A character vector of reference groups to use for annotation.</p></dd>


<dt id="arg-normalization-method">normalization_method<a class="anchor" aria-label="anchor" href="#arg-normalization-method"></a></dt>
<dd><p>normalization method used during <code>FindTransferAnchors</code>,
Default: 'LogNormalize'</p></dd>


<dt id="arg-reduction">reduction<a class="anchor" aria-label="anchor" href="#arg-reduction"></a></dt>
<dd><p>reduction method used during <code>FindTransferAnchors</code>, Default: 'cca'</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method to use for annotation, either "Seurat" or "nmf".</p></dd>


<dt id="arg-min-prediction-score">min_prediction_score<a class="anchor" aria-label="anchor" href="#arg-min-prediction-score"></a></dt>
<dd><p>Minimum prediction score for the annotation to be considered valid.
Labels with a prediction score below this value will be labelled as "Unknown". Default: 0,
meaning that not threshold is used.</p></dd>


<dt id="arg-skip-normalization">skip_normalization<a class="anchor" aria-label="anchor" href="#arg-skip-normalization"></a></dt>
<dd><p>If TRUE, the datasets will not be normalized prior to annotation.
This parameter only has an effect if <code>method</code> is set to "nmf". The default layer will be
used, so use this setting at your own risk.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If TRUE, print messages about the progress of the annotation.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters to <code>FindTransferAnchors</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The initial Seurat object with additional annotation columns added to its metadata.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The "Seurat" method is a wrapper for the <code>FindTransferAnchors</code> and <code>TransferData</code>
functions from Seurat, followed by an optional summary per cluster.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Download reference file</span></span></span>
<span class="r-in"><span><span class="va">reference</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"https://pixelgen-technologies-datasets.s3.eu-north-1.amazonaws.com/"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"mpx-analysis/next/R/pbmc_annotation.rds"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Does not work on the test data due to small size - ignore for now.</span></span></span>
<span class="r-in"><span><span class="va">seur</span> <span class="op">&lt;-</span> <span class="fu"><a href="ReadPNA_Seurat.html">ReadPNA_Seurat</a></span><span class="op">(</span><span class="fu"><a href="pna_dataset.html">minimal_pna_pxl_file</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">seur</span> <span class="op">&lt;-</span> <span class="fu">AnnotateCells</span><span class="op">(</span><span class="va">seur</span>,</span></span>
<span class="r-in"><span>  reference <span class="op">=</span> <span class="va">reference</span>, query_assay <span class="op">=</span> <span class="st">"PNA"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>© Pixelgen Technologies 2024 | <a href="https://www.pixelgen.com/cookie-policy/" class="external-link">About cookies</a> | <a href="https://www.pixelgen.com/privacy-policy/" class="external-link">Privacy policy</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

