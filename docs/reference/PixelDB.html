<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PXL database class — PixelDB • pixelatorR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PXL database class — PixelDB"><meta name="description" content="PXL database class
PXL database class"><meta property="og:description" content="PXL database class
PXL database class"><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pixelatorR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.13.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/load_data.html">Load Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PixelgenTechnologies/pixelatorR" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>PXL database class</h1>

      <div class="d-none name"><code>PixelDB.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>PXL database class</p>
<p>PXL database class</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This class provides an interface for working with a PXL file.
A PXL file is a duckdb database that contains various tables created
by the Pixelator data processing pipeline.</p>
<p>The class provides methods to query the database and extract information
from it. The class is intended to be used internally by the package but
is exposed to the user for advanced use cases.</p>
<p>Example usage:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="co"># Create a PixelDB object with a connection to a PXL file</span></span>
<span><span class="va">pxl_db</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PixelDB.html">PixelDB</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"path/to/pxl/file"</span><span class="op">)</span></span>
<span><span class="va">pxl_db</span><span class="op">$</span><span class="fu">info</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch count matrix</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="va">pxl_db</span><span class="op">$</span><span class="fu">counts</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch proximity scores</span></span>
<span><span class="va">proximity</span> <span class="op">&lt;-</span> <span class="va">pxl_db</span><span class="op">$</span><span class="fu">proximity</span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-PixelDB-new"><code>PixelDB$new()</code></a></p></li>
<li><p><a href="#method-PixelDB-finalize"><code>PixelDB$finalize()</code></a></p></li>
<li><p><a href="#method-PixelDB-info"><code>PixelDB$info()</code></a></p></li>
<li><p><a href="#method-PixelDB-query"><code>PixelDB$query()</code></a></p></li>
<li><p><a href="#method-PixelDB-reconnect"><code>PixelDB$reconnect()</code></a></p></li>
<li><p><a href="#method-PixelDB-check_connection"><code>PixelDB$check_connection()</code></a></p></li>
<li><p><a href="#method-PixelDB-names"><code>PixelDB$names()</code></a></p></li>
<li><p><a href="#method-PixelDB-fetch_table"><code>PixelDB$fetch_table()</code></a></p></li>
<li><p><a href="#method-PixelDB-fetch_table_subset"><code>PixelDB$fetch_table_subset()</code></a></p></li>
<li><p><a href="#method-PixelDB-counts"><code>PixelDB$counts()</code></a></p></li>
<li><p><a href="#method-PixelDB-proximity"><code>PixelDB$proximity()</code></a></p></li>
<li><p><a href="#method-PixelDB-cell_meta"><code>PixelDB$cell_meta()</code></a></p></li>
<li><p><a href="#method-PixelDB-protein_meta"><code>PixelDB$protein_meta()</code></a></p></li>
<li><p><a href="#method-PixelDB-run_meta"><code>PixelDB$run_meta()</code></a></p></li>
<li><p><a href="#method-PixelDB-components_edgelist"><code>PixelDB$components_edgelist()</code></a></p></li>
<li><p><a href="#method-PixelDB-components_layout"><code>PixelDB$components_layout()</code></a></p></li>
<li><p><a href="#method-PixelDB-components_marker_counts"><code>PixelDB$components_marker_counts()</code></a></p></li>
<li><p><a href="#method-PixelDB-export_parquet"><code>PixelDB$export_parquet()</code></a></p></li>
<li><p><a href="#method-PixelDB-close"><code>PixelDB$close()</code></a></p></li>
</ul></div><p></p><hr><a id="method-PixelDB-new"></a><div class="section">
<h3 id="method-new-">Method <code><a href="https://rdrr.io/r/methods/new.html" class="external-link">new()</a></code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Set up a connection to a PXL file</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/PixelDB.html">PixelDB</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">file</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>file</code></dt>
<dd><p>A path to a PXL file</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>An <code>R6</code> object representing the PXL database</p>
</div>
<div class="section">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pxl_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pna_dataset.html">minimal_pna_pxl_file</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">db</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PixelDB.html">PixelDB</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">pxl_file</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-finalize"></a><div class="section">
<h3 id="method-finalize-">Method <code>finalize()</code><a class="anchor" aria-label="anchor" href="#method-finalize-"></a></h3>
<p>Cleanup method that is called when the <code>PixelDB</code> object is garbage collected</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">finalize</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>Nothing</p>
</div>
<div class="section">
<h4 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="va">db</span><span class="op">$</span><span class="va">.__enclos_env__</span><span class="op">$</span><span class="va">private</span><span class="op">$</span><span class="va">con</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span>full <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Connection should now be closed</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbIsValid.html" class="external-link">dbIsValid</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span> <span class="co"># FALSE</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-info"></a><div class="section">
<h3 id="method-info-">Method <code>info()</code><a class="anchor" aria-label="anchor" href="#method-info-"></a></h3>
<p>Show information about tables in the PXL file</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">info</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>A <code>tbl_df</code> with information about tables in the PXL file</p>
</div>
<div class="section">
<h4 id="examples-2">Examples<a class="anchor" aria-label="anchor" href="#examples-2"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PixelDB.html">PixelDB</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">pxl_file</span><span class="op">)</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">info</span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-query"></a><div class="section">
<h3 id="method-query-">Method <code>query()</code><a class="anchor" aria-label="anchor" href="#method-query-"></a></h3>
<p>Send a database query</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="va">sql</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>sql</code></dt>
<dd><p>An SQL query</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>A <code>data.frame</code> with the results of the query</p>
</div>
<div class="section">
<h4 id="examples-3">Examples<a class="anchor" aria-label="anchor" href="#examples-3"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Select the proximity score table</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="st">"SELECT * FROM proximity"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-reconnect"></a><div class="section">
<h3 id="method-reconnect-">Method <code>reconnect()</code><a class="anchor" aria-label="anchor" href="#method-reconnect-"></a></h3>
<p>Method to reconnect to the PXL file. This is useful if the connection is lost,
for instance if the R session restarted.</p>
<p>If the method fails, an error is thrown.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">reconnect</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>Nothing</p>
</div>
<div class="section">
<h4 id="examples-4">Examples<a class="anchor" aria-label="anchor" href="#examples-4"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="va">db</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">reconnect</span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-check_connection"></a><div class="section">
<h3 id="method-check-connection-">Method <code>check_connection()</code><a class="anchor" aria-label="anchor" href="#method-check-connection-"></a></h3>
<p>Check the connection to the PXL database</p>
<p>If the connection is invalid, the <code>$reconnect()</code> method is called.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">check_connection</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>Nothing</p>
</div>
<div class="section">
<h4 id="examples-5">Examples<a class="anchor" aria-label="anchor" href="#examples-5"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># If the connection is closed, the method will attempt to reconnect</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">check_connection</span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-names"></a><div class="section">
<h3 id="method-names-">Method <code><a href="https://rdrr.io/r/base/names.html" class="external-link">names()</a></code><a class="anchor" aria-label="anchor" href="#method-names-"></a></h3>
<p>Get the names of the tables in the database</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">names</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>A character vector with table names that can be used
in <code>$fetch_table()</code></p>
</div>
<div class="section">
<h4 id="examples-6">Examples<a class="anchor" aria-label="anchor" href="#examples-6"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Get the table names</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">names</span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-fetch_table"></a><div class="section">
<h3 id="method-fetch-table-">Method <code>fetch_table()</code><a class="anchor" aria-label="anchor" href="#method-fetch-table-"></a></h3>
<p>Fetches an entire table from the database</p>
<p>This general method can be used to fetch any table from the database.
Large tables such as the edgelist are not recommended to be fetched in this way
as you will get the entire table in memory.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">fetch_table</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>The name of the table</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p>A <code>data.frame</code> with the table contents</p>
</div>
<div class="section">
<h4 id="examples-7">Examples<a class="anchor" aria-label="anchor" href="#examples-7"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Fetch any table from the database</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">fetch_table</span><span class="op">(</span><span class="st">"proximity"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-fetch_table_subset"></a><div class="section">
<h3 id="method-fetch-table-subset-">Method <code>fetch_table_subset()</code><a class="anchor" aria-label="anchor" href="#method-fetch-table-subset-"></a></h3>
<p>Fetches a subset of columns from a table in the database</p>
<p>This method can be used to fetch a subset of columns from a table in the database.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">fetch_table_subset</span><span class="op">(</span><span class="va">name</span>, <span class="va">columns_filter</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>The name of the table</p></dd>


<dt><code>columns_filter</code></dt>
<dd><p>A named list</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-8">Returns<a class="anchor" aria-label="anchor" href="#returns-8"></a></h4>
<p>A <code>data.frame</code> with the table contents</p>
</div>
<div class="section">
<h4 id="examples-8">Examples<a class="anchor" aria-label="anchor" href="#examples-8"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Fetch any table from the database and filter on the fly</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">fetch_table_subset</span><span class="op">(</span></span>
<span>  <span class="st">"proximity"</span>,</span>
<span>  columns_filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"component"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0a45497c6bfbfb22"</span>, <span class="st">"2708240b908e2eba"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-counts"></a><div class="section">
<h3 id="method-counts-">Method <code>counts()</code><a class="anchor" aria-label="anchor" href="#method-counts-"></a></h3>
<p>Fetches the __adata__X count table from the database and converts it to a sparse <code>dgCMatrix</code></p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">counts</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-9">Returns<a class="anchor" aria-label="anchor" href="#returns-9"></a></h4>
<p>A sparse matrix of class <code>dgCMatrix</code> with antibody counts</p>
</div>
<div class="section">
<h4 id="examples-9">Examples<a class="anchor" aria-label="anchor" href="#examples-9"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Fetch the antibody counts</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">db</span><span class="op">$</span><span class="fu">counts</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-proximity"></a><div class="section">
<h3 id="method-proximity-">Method <code>proximity()</code><a class="anchor" aria-label="anchor" href="#method-proximity-"></a></h3>
<p>Fetches the proximity scores from the database</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">proximity</span><span class="op">(</span>calc_log2_ratio <span class="op">=</span> <span class="cn">TRUE</span>, lazy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>calc_log2_ratio</code></dt>
<dd><p>A logical specifying whether to calculate and add
a log2ratio column to the output table. Default is <code>TRUE</code></p></dd>


<dt><code>lazy</code></dt>
<dd><p>A logical specifying whether to load the data lazily. If <code>TRUE</code>,
a <code>tbl_lazy</code> object is returned.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-10">Returns<a class="anchor" aria-label="anchor" href="#returns-10"></a></h4>
<p>A <code>tbl_df</code> with the proximity scores</p>
</div>
<div class="section">
<h4 id="examples-10">Examples<a class="anchor" aria-label="anchor" href="#examples-10"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Fetch the proximity scores</span></span>
<span><span class="va">prox</span> <span class="op">&lt;-</span> <span class="va">db</span><span class="op">$</span><span class="fu">proximity</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">prox</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-cell_meta"></a><div class="section">
<h3 id="method-cell-meta-">Method <code>cell_meta()</code><a class="anchor" aria-label="anchor" href="#method-cell-meta-"></a></h3>
<p>Fetches the __adata__obs meta data</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">cell_meta</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-11">Returns<a class="anchor" aria-label="anchor" href="#returns-11"></a></h4>
<p>A <code>data.frame</code> with the cell meta data</p>
</div>
<div class="section">
<h4 id="examples-11">Examples<a class="anchor" aria-label="anchor" href="#examples-11"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Fetch the cell meta data</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">cell_meta</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-protein_meta"></a><div class="section">
<h3 id="method-protein-meta-">Method <code>protein_meta()</code><a class="anchor" aria-label="anchor" href="#method-protein-meta-"></a></h3>
<p>Fetches the __adata__var meta data</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">protein_meta</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-12">Returns<a class="anchor" aria-label="anchor" href="#returns-12"></a></h4>
<p>A <code>data.frame</code> with the protein meta data</p>
</div>
<div class="section">
<h4 id="examples-12">Examples<a class="anchor" aria-label="anchor" href="#examples-12"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Fetch the protein meta data</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">protein_meta</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-run_meta"></a><div class="section">
<h3 id="method-run-meta-">Method <code>run_meta()</code><a class="anchor" aria-label="anchor" href="#method-run-meta-"></a></h3>
<p>Fetch the run meta data</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">run_meta</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-13">Returns<a class="anchor" aria-label="anchor" href="#returns-13"></a></h4>
<p>A <code>tbl_df</code> with the run meta data</p>
</div>
<div class="section">
<h4 id="examples-13">Examples<a class="anchor" aria-label="anchor" href="#examples-13"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Fetch the run meta data</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">run_meta</span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-components_edgelist"></a><div class="section">
<h3 id="method-components-edgelist-">Method <code>components_edgelist()</code><a class="anchor" aria-label="anchor" href="#method-components-edgelist-"></a></h3>
<p>Fetches a component edgelist or the entire edgelist from the database</p>
<p>The UMIs are encoded as int64 but since R doesn't support int64, the UMIs can be converted to
character vectors be specifying the <code>umi_data_type</code>.</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">components_edgelist</span><span class="op">(</span></span>
<span>  <span class="va">components</span>,</span>
<span>  umi_data_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"int64"</span>, <span class="st">"string"</span>, <span class="st">"suffixed_string"</span><span class="op">)</span>,</span>
<span>  lazy <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  include_all_columns <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>components</code></dt>
<dd><p>A character vector with component names or NULL to get all components</p></dd>


<dt><code>umi_data_type</code></dt>
<dd><p>One of "int64", "string" or "suffixed_string". Default is "int64".</p><ul><li><p>"int64": The UMIs are encoded as int64</p></li>
<li><p>"string": The UMIs are encoded as character</p></li>
<li><p>"suffixed_string": The UMIs are encoded as character with a suffix '-umi1' or '-umi2' added</p></li>
</ul></dd>


<dt><code>lazy</code></dt>
<dd><p>A logical specifying whether to load the data lazily. If <code>TRUE</code>,
a <code>tbl_lazy</code> object is returned.</p></dd>


<dt><code>include_all_columns</code></dt>
<dd><p>Logical specifying whether to include all columns in the output.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-14">Returns<a class="anchor" aria-label="anchor" href="#returns-14"></a></h4>
<p>A <code>data.frame</code> with the component edgelist:</p><ul><li><p>umi1: A unique ID of the first RCA product</p></li>
<li><p>umi2: A unique ID of the second RCA product</p></li>
<li><p>marker_1: The first protein</p></li>
<li><p>marker_2: The second protein</p></li>
<li><p>component: The component name</p></li>
<li><p>read_count: The number of reads supporting the edge</p></li>
<li><p>uei_count: The number of unique event identifiers (UEIs) supporting the edge</p></li>
</ul></div>
<div class="section">
<h4 id="examples-14">Examples<a class="anchor" aria-label="anchor" href="#examples-14"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Fetch edgelists</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">components_edgelist</span><span class="op">(</span><span class="st">"0a45497c6bfbfb22"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-components_layout"></a><div class="section">
<h3 id="method-components-layout-">Method <code>components_layout()</code><a class="anchor" aria-label="anchor" href="#method-components-layout-"></a></h3>
<p>Fetches layout for selected components</p>
<p>This method fetches the x, y, z layout coordinates for selected PNA <code>components</code>.</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">components_layout</span><span class="op">(</span></span>
<span>  <span class="va">components</span>,</span>
<span>  add_marker_counts <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>components</code></dt>
<dd><p>A vector of component names or NULL for all components</p></dd>


<dt><code>add_marker_counts</code></dt>
<dd><p>Add marker counts in wide format to the layout tables</p></dd>


<dt><code>verbose</code></dt>
<dd><p>Print messages</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-15">Returns<a class="anchor" aria-label="anchor" href="#returns-15"></a></h4>
<p>A list with <code>tbl_df</code>'s with the layout coordinates and optionally marker counts</p>
</div>
<div class="section">
<h4 id="examples-15">Examples<a class="anchor" aria-label="anchor" href="#examples-15"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code># Fetch layouts (NOTE: This will only work if the layouts exist in the database)
\dontrun{
db$components_layout("0a45497c6bfbfb22")[[1]] %&gt;% head()
}

</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-components_marker_counts"></a><div class="section">
<h3 id="method-components-marker-counts-">Method <code>components_marker_counts()</code><a class="anchor" aria-label="anchor" href="#method-components-marker-counts-"></a></h3>
<p>Fetches marker counts for components</p>
<p>This method fetches the node marker counts for selected <code>components</code>. The node IDs
are stored in the <code>name</code> column. If <code>components</code> is <code>NULL</code>, all
component marker counts are returned with an additional <code>components</code> column in
the resulting table.</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">components_marker_counts</span><span class="op">(</span></span>
<span>  <span class="va">components</span>,</span>
<span>  as_sparse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>components</code></dt>
<dd><p>A vector of component IDs or NULL for all components</p></dd>


<dt><code>as_sparse</code></dt>
<dd><p>Return the marker counts as a sparse matrix</p></dd>


<dt><code>verbose</code></dt>
<dd><p>Print messages</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-16">Returns<a class="anchor" aria-label="anchor" href="#returns-16"></a></h4>
<p>A list with <code>dgCMatrix</code> matrices or <code>tbl_df</code>'s with the marker counts</p>
</div>
<div class="section">
<h4 id="examples-16">Examples<a class="anchor" aria-label="anchor" href="#examples-16"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Fetch marker counts</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">components_marker_counts</span><span class="op">(</span><span class="st">"0a45497c6bfbfb22"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-export_parquet"></a><div class="section">
<h3 id="method-export-parquet-">Method <code>export_parquet()</code><a class="anchor" aria-label="anchor" href="#method-export-parquet-"></a></h3>
<p>Export a table to a parquet file</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">export_parquet</span><span class="op">(</span></span>
<span>  <span class="va">parquet_file</span>,</span>
<span>  table_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"proximity"</span>, <span class="st">"edgelist"</span>, <span class="st">"layouts"</span><span class="op">)</span>,</span>
<span>  compression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"snappy"</span>, <span class="st">"zstd"</span><span class="op">)</span>,</span>
<span>  compression_level <span class="op">=</span> <span class="fl">1L</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>parquet_file</code></dt>
<dd><p>Path to the parquet file</p></dd>


<dt><code>table_name</code></dt>
<dd><p>The name of the table to export</p></dd>


<dt><code>compression</code></dt>
<dd><p>The compression algorithm to use. Options are 'snappy' and 'zstd'.</p></dd>


<dt><code>compression_level</code></dt>
<dd><p>The compression level to use. Default is 1. Only used when
compression is 'zstd'.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-17">Returns<a class="anchor" aria-label="anchor" href="#returns-17"></a></h4>
<p>Nothing</p>
</div>
<div class="section">
<h4 id="examples-17">Examples<a class="anchor" aria-label="anchor" href="#examples-17"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Export a table to a parquet file</span></span>
<span><span class="va">tmp_parquet_file</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_temp.html" class="external-link">file_temp</a></span><span class="op">(</span>ext <span class="op">=</span> <span class="st">"parquet"</span><span class="op">)</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">export_parquet</span><span class="op">(</span><span class="va">tmp_parquet_file</span>, <span class="st">"proximity"</span><span class="op">)</span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_access.html" class="external-link">file_exists</a></span><span class="op">(</span><span class="va">tmp_parquet_file</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-PixelDB-close"></a><div class="section">
<h3 id="method-close-">Method <code><a href="https://rdrr.io/r/base/connections.html" class="external-link">close()</a></code><a class="anchor" aria-label="anchor" href="#method-close-"></a></h3>
<p>Close connection</p><div class="section">
<h4 id="usage-18">Usage<a class="anchor" aria-label="anchor" href="#usage-18"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PixelDB</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-18">Returns<a class="anchor" aria-label="anchor" href="#returns-18"></a></h4>
<p>Nothing</p>
</div>
<div class="section">
<h4 id="examples-18">Examples<a class="anchor" aria-label="anchor" href="#examples-18"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co"># Close the connection when finished</span></span>
<span><span class="va">db</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span>
<span></span></code></pre></div><p></p></div>
</div>


</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$new`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pxl_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="pna_dataset.html">minimal_pna_pxl_file</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="va">PixelDB</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">pxl_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$finalize`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="va">db</span><span class="op">$</span><span class="va">.__enclos_env__</span><span class="op">$</span><span class="va">private</span><span class="op">$</span><span class="va">con</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span>full <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            used  (Mb) gc trigger  (Mb) limit (Mb) max used  (Mb)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ncells  7688426 410.7   13293758 710.0         NA 13293758 710.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vcells 21974095 167.7   26104806 199.2      32768 26104806 199.2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Connection should now be closed</span></span></span>
<span class="r-in"><span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbIsValid.html" class="external-link">dbIsValid</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span> <span class="co"># FALSE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$info`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="va">PixelDB</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">pxl_file</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">info</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    database         schema name              column_names column_types temporary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> minimal_PNA_PBMC main   __adata__X        <span style="color: #949494;">&lt;chr [159]&gt;</span>  <span style="color: #949494;">&lt;chr [159]&gt;</span>  FALSE    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> minimal_PNA_PBMC main   __adata__obs      <span style="color: #949494;">&lt;chr [24]&gt;</span>   <span style="color: #949494;">&lt;chr [24]&gt;</span>   FALSE    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> minimal_PNA_PBMC main   __adata__obsm_clr <span style="color: #949494;">&lt;chr [159]&gt;</span>  <span style="color: #949494;">&lt;chr [159]&gt;</span>  FALSE    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> minimal_PNA_PBMC main   __adata__obsm_lo… <span style="color: #949494;">&lt;chr [159]&gt;</span>  <span style="color: #949494;">&lt;chr [159]&gt;</span>  FALSE    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> minimal_PNA_PBMC main   __adata__uns      <span style="color: #949494;">&lt;chr [1]&gt;</span>    <span style="color: #949494;">&lt;chr [1]&gt;</span>    FALSE    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> minimal_PNA_PBMC main   __adata__var      <span style="color: #949494;">&lt;chr [6]&gt;</span>    <span style="color: #949494;">&lt;chr [6]&gt;</span>    FALSE    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> minimal_PNA_PBMC main   edgelist          <span style="color: #949494;">&lt;chr [7]&gt;</span>    <span style="color: #949494;">&lt;chr [7]&gt;</span>    FALSE    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> minimal_PNA_PBMC main   layouts           <span style="color: #949494;">&lt;chr [8]&gt;</span>    <span style="color: #949494;">&lt;chr [8]&gt;</span>    FALSE    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> minimal_PNA_PBMC main   metadata          <span style="color: #949494;">&lt;chr [1]&gt;</span>    <span style="color: #949494;">&lt;chr [1]&gt;</span>    FALSE    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> minimal_PNA_PBMC main   proximity         <span style="color: #949494;">&lt;chr [8]&gt;</span>    <span style="color: #949494;">&lt;chr [8]&gt;</span>    FALSE    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$query`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select the proximity score table</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">query</span><span class="op">(</span><span class="st">"SELECT * FROM proximity"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   marker_1 marker_2 join_count join_count_expected_mean join_count_expected_sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     CD56     CD56          0                     0.00              0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     CD56   mIgG2b          0                     0.03              0.1714466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     CD56     CD71          0                     0.01              0.1000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     CD56      CD6          0                     2.07              1.5843617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     CD56 Siglec-9          0                     0.03              0.1714466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     CD56    CD79a          0                     0.00              0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   join_count_z join_count_p        component</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      0.00000   0.50000000 c3c393e9a17c1981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     -0.03000   0.48803353 c3c393e9a17c1981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     -0.01000   0.49601064 c3c393e9a17c1981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     -1.30652   0.09568792 c3c393e9a17c1981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     -0.03000   0.48803353 c3c393e9a17c1981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      0.00000   0.50000000 c3c393e9a17c1981</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$reconnect`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">reconnect</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Connected</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$check_connection`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If the connection is closed, the method will attempt to reconnect</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">check_connection</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$names`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get the table names</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">names</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "__adata__X"          "__adata__obs"        "__adata__obsm_clr"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4] "__adata__obsm_log1p" "__adata__uns"        "__adata__var"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "edgelist"            "layouts"             "metadata"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "proximity"          </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$fetch_table`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fetch any table from the database</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">fetch_table</span><span class="op">(</span><span class="st">"proximity"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   marker_1 marker_2 join_count join_count_expected_mean join_count_expected_sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     CD56     CD56          0                     0.00              0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     CD56   mIgG2b          0                     0.03              0.1714466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     CD56     CD71          0                     0.01              0.1000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     CD56      CD6          0                     2.07              1.5843617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     CD56 Siglec-9          0                     0.03              0.1714466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     CD56    CD79a          0                     0.00              0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   join_count_z join_count_p        component</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      0.00000   0.50000000 c3c393e9a17c1981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     -0.03000   0.48803353 c3c393e9a17c1981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     -0.01000   0.49601064 c3c393e9a17c1981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     -1.30652   0.09568792 c3c393e9a17c1981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     -0.03000   0.48803353 c3c393e9a17c1981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      0.00000   0.50000000 c3c393e9a17c1981</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$fetch_table_subset`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fetch any table from the database and filter on the fly</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">fetch_table_subset</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"proximity"</span>,</span></span>
<span class="r-in"><span>  columns_filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"component"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0a45497c6bfbfb22"</span>, <span class="st">"2708240b908e2eba"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   marker_1 marker_2 join_count join_count_expected_mean join_count_expected_sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    CD278    CD278          0                        0                      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    CD278   HLA-DQ          0                        0                      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    CD278    CD314          0                        0                      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    CD278    VISTA          0                        0                      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    CD278    CD326          0                        0                      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    CD278     CD28          0                        0                      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   join_count_z join_count_p        component</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            0          0.5 0a45497c6bfbfb22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            0          0.5 0a45497c6bfbfb22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            0          0.5 0a45497c6bfbfb22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            0          0.5 0a45497c6bfbfb22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            0          0.5 0a45497c6bfbfb22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6            0          0.5 0a45497c6bfbfb22</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$counts`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fetch the antibody counts</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">db</span><span class="op">$</span><span class="fu">counts</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0a45497c6bfbfb22 2708240b908e2eba c3c393e9a17c1981 d4074c845bb62800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HLA-ABC              865             2077             2480             2994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B2M                 1182             3448             5307             9753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CD11b                929               12               17                6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CD11c                133             1354               26                8</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$proximity`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fetch the proximity scores</span></span></span>
<span class="r-in"><span><span class="va">prox</span> <span class="op">&lt;-</span> <span class="va">db</span><span class="op">$</span><span class="fu">proximity</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prox</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   marker_1 marker_2 join_count join_count_expected_mean join_count_expected_sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> CD56     CD56              0                     0                     0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> CD56     mIgG2b            0                     0.03                  0.171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> CD56     CD71              0                     0.01                  0.1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> CD56     CD6               0                     2.07                  1.58 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> CD56     Siglec-9          0                     0.03                  0.171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> CD56     CD79a             0                     0                     0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: join_count_z &lt;dbl&gt;, join_count_p &lt;dbl&gt;, component &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   log2_ratio &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$cell_meta`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fetch the cell meta data</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">cell_meta</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  n_umi1 n_umi2 n_edges n_antibodies reads_in_component n_umi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0a45497c6bfbfb22  18560  24983   97014          149             289856 43543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2708240b908e2eba  16301  21364   79638          158             229977 37665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3c393e9a17c1981  21257  28094  110657          158             298516 49351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d4074c845bb62800  26891  38821  141153          156             372618 65712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> efe0ed189cb499fc  19617  29019  100132          142             266795 48636</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  isotype_fraction intracellular_fraction tau_type       tau</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0a45497c6bfbfb22     0.0003674529                      0   normal 0.9865152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2708240b908e2eba     0.0010885437                      0   normal 0.9563997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3c393e9a17c1981     0.0022086685                      0   normal 0.9661265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d4074c845bb62800     0.0003956659                      0   normal 0.9818987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> efe0ed189cb499fc     0.0002467308                      0   normal 0.9794434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              sample antibodies average_k_core k_core_1 k_core_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0a45497c6bfbfb22 PNA055_Sample07_S7        149       2.569093    10260     6046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2708240b908e2eba PNA055_Sample07_S7        158       2.466507     9596     6826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3c393e9a17c1981 PNA055_Sample07_S7        158       2.639055    11845     8817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d4074c845bb62800 PNA055_Sample07_S7        156       2.474403    16575    11611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> efe0ed189cb499fc PNA055_Sample07_S7        142       2.310058    12156     9552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  k_core_3 k_core_4 k_core_5 svd_var_expl_s1 svd_var_expl_s2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0a45497c6bfbfb22    19434     7803        0       0.4784136       0.1302096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2708240b908e2eba    15319     5924        0       0.2922660       0.1960881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3c393e9a17c1981    13995    14694        0       0.3671295       0.1443445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d4074c845bb62800    27303    10223        0       0.4026852       0.2052466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> efe0ed189cb499fc    26620      308        0       0.3301883       0.1886183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  svd_var_expl_s3 A_nodes_mean_degree B_nodes_mean_degree</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0a45497c6bfbfb22      0.08249094            5.227047            3.883201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2708240b908e2eba      0.09845118            4.885467            3.727673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c3c393e9a17c1981      0.11940564            5.205673            3.938813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d4074c845bb62800      0.06080128            5.249080            3.635996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> efe0ed189cb499fc      0.10618119            5.104348            3.450567</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$protein_meta`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fetch the protein meta data</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">protein_meta</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         antibody_count antibody_pct components control nuclear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HLA-ABC         483065 0.0562623443        193      no      no</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B2M            1095103 0.1275461109        193      no      no</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CD11b             7907 0.0009209244        189      no      no</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CD11c            34574 0.0040268169        192      no      no</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CD18             90833 0.0105792751        192      no      no</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CD82             87827 0.0102291677        193      no      no</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$run_meta`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fetch the run meta data</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">run_meta</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sample_name        version technology   panel_name panel_version post_analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;named list&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> PNA055_Sample07_S7 0.1.0   single-cell… pna-rnd-1… 0.1.0         <span style="color: #949494;">&lt;named list&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$components_edgelist`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fetch edgelists</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">components_edgelist</span><span class="op">(</span><span class="st">"0a45497c6bfbfb22"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   marker_1 marker_2    umi1    umi2 component       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int64&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int64&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> HLA-ABC  HLA-ABC    6 <span style="color: #949494;">e</span>16   5 <span style="color: #949494;">e</span>16 0a45497c6bfbfb22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> HLA-ABC  HLA-ABC    6 <span style="color: #949494;">e</span>16   4 <span style="color: #949494;">e</span>16 0a45497c6bfbfb22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> HLA-ABC  HLA-ABC    1.<span style="color: #949494;">e</span>16   4 <span style="color: #949494;">e</span>15 0a45497c6bfbfb22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> HLA-ABC  HLA-ABC    5.<span style="color: #949494;">e</span>16   2.<span style="color: #949494;">e</span>16 0a45497c6bfbfb22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> HLA-ABC  HLA-ABC    6 <span style="color: #949494;">e</span>16   6 <span style="color: #949494;">e</span>16 0a45497c6bfbfb22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> HLA-ABC  HLA-ABC    1 <span style="color: #949494;">e</span>16   1.<span style="color: #949494;">e</span>16 0a45497c6bfbfb22</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$components_layout`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fetch layouts (NOTE: This will only work if the layouts exist in the database)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">components_layout</span><span class="op">(</span><span class="st">"0a45497c6bfbfb22"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$components_marker_counts`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fetch marker counts</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">components_marker_counts</span><span class="op">(</span><span class="st">"0a45497c6bfbfb22"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   name                   `HLA-ABC`   B2M  CD18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 61208583141770358-umi1         1     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 20908764047174569-umi1         0     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 71855263655827950-umi1         0     1     0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$export_parquet`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Export a table to a parquet file</span></span></span>
<span class="r-in"><span><span class="va">tmp_parquet_file</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_temp.html" class="external-link">file_temp</a></span><span class="op">(</span>ext <span class="op">=</span> <span class="st">"parquet"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">export_parquet</span><span class="op">(</span><span class="va">tmp_parquet_file</span>, <span class="st">"proximity"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/file_access.html" class="external-link">file_exists</a></span><span class="op">(</span><span class="va">tmp_parquet_file</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> /var/folders/gw/bdcqhnvs0m9gs_mq8n51jtbc0000gn/T/RtmplGz5wi/file14f496f37da39.parquet </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                                  TRUE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `PixelDB$close`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Close the connection when finished</span></span></span>
<span class="r-in"><span><span class="va">db</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>© Pixelgen Technologies 2024 | <a href="https://www.pixelgen.com/cookie-policy/" class="external-link">About cookies</a> | <a href="https://www.pixelgen.com/privacy-policy/" class="external-link">Privacy policy</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

