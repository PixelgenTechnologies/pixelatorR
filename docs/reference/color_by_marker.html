<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add node colors to a CellGraph — color_by_marker • pixelatorR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add node colors to a CellGraph — color_by_marker"><meta name="description" content="Adds node colors based on the expression of a single or multiple
markers. If multiple markers are provided, their values are either
multiplied or summed depending on the mode."><meta property="og:description" content="Adds node colors based on the expression of a single or multiple
markers. If multiple markers are provided, their values are either
multiplied or summed depending on the mode."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pixelatorR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.12.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/load_data.html">Load Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PixelgenTechnologies/pixelatorR" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Add node colors to a <code>CellGraph</code></h1>

      <div class="d-none name"><code>color_by_marker.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Adds node colors based on the expression of a single or multiple
markers. If multiple markers are provided, their values are either
multiplied or summed depending on the <code>mode</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">color_by_marker</span><span class="op">(</span></span>
<span>  <span class="va">cg</span>,</span>
<span>  <span class="va">markers</span>,</span>
<span>  smooth_counts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  palette <span class="op">=</span> <span class="st">"viridis"</span>,</span>
<span>  rev_pal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"product"</span>, <span class="st">"sum"</span><span class="op">)</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trim_quantiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  nNodes <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cg">cg<a class="anchor" aria-label="anchor" href="#arg-cg"></a></dt>
<dd><p>A <code><a href="CellGraph-class.html">CellGraph</a></code> object</p></dd>


<dt id="arg-markers">markers<a class="anchor" aria-label="anchor" href="#arg-markers"></a></dt>
<dd><p>A character vector with valid marker IDs</p></dd>


<dt id="arg-smooth-counts">smooth_counts<a class="anchor" aria-label="anchor" href="#arg-smooth-counts"></a></dt>
<dd><p>Applies neighborhood smoothing of marker counts.
Each node marker counts is combined with the sum of marker counts in
a neighborhood of length 1.</p></dd>


<dt id="arg-palette">palette<a class="anchor" aria-label="anchor" href="#arg-palette"></a></dt>
<dd><p>A valid color palette from <code>RColorBrewer</code> or <code>viridis</code>
or a vector of colors.</p></dd>


<dt id="arg-rev-pal">rev_pal<a class="anchor" aria-label="anchor" href="#arg-rev-pal"></a></dt>
<dd><p>Should the palette be reversed?</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>Only used if more than 1 marker is provided. With <code>mode = "product"</code>,
the marker counts are multiplied and with <code>mode = "sum"</code>, the marker counts are
summed. This step is executed after smoothing.</p></dd>


<dt id="arg-normalize">normalize<a class="anchor" aria-label="anchor" href="#arg-normalize"></a></dt>
<dd><p>Apply normalization to the marker counts after smoothing and
the multiplication/summation step. The values are first divided by the node degree
followed by log-transformation with <code>log1p</code>.</p></dd>


<dt id="arg-trim-quantiles">trim_quantiles<a class="anchor" aria-label="anchor" href="#arg-trim-quantiles"></a></dt>
<dd><p>A numeric vector of length 2 specifying quantiles to trim.
This can be useful to reduce the influence of outliers. The specified quantiles
are calculated from the marker counts values prior to normalization.
(see section below for details)</p></dd>


<dt id="arg-nnodes">nNodes<a class="anchor" aria-label="anchor" href="#arg-nnodes"></a></dt>
<dd><p>Number of nodes to keep in the graph</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="trim-quantile">Trim quantile<a class="anchor" aria-label="anchor" href="#trim-quantile"></a></h2>


<p>Sometimes, a few outliers can dominate which makes the colors difficult to interpret.
With <code>trim_quantiles</code>, we can remove such outliers. By setting the upper bound to
0.99, we are calculating the 99th quantile of the marker count values and any values
above this threshold are replaced with the value for the 99th quantile. The same
thing applies to the lower bound but the other way around.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>© Pixelgen Technologies 2024 | <a href="https://www.pixelgen.com/cookie-policy/" class="external-link">About cookies</a> | <a href="https://www.pixelgen.com/privacy-policy/" class="external-link">Privacy policy</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

